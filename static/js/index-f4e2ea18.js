var Zl=Object.defineProperty;var Ql=(_,t,e)=>t in _?Zl(_,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):_[t]=e;var a=(_,t,e)=>(Ql(_,typeof t!="symbol"?t+"":t,e),e);import{ae as vt,o as g,S as M,R as c,an as Dl,T as vl,ao as ea,E as J,b as ie,h as ta,c as v,O as n,P as k,ag as B,u as d,A as $e,a as I,V as N,W as T,X as pe,x as G,U as Sl,J as me,ap as mt,aq as Nl,n as la,L as aa,d as gt,I as sa,ar as ol,as as ul}from"./@vue-d0ae6b81.js";/* empty css                    */import{E as bl,a as xl,b as Ge,c as nt,d as We,e as ye,f as Me,g as je,h as Ae,i as Xe,j as ct,k as ia,l as cl,m as wl,n as na,o as dl,p as Cl,q as Rl,r as ra,s as oa,t as ua}from"./element-plus-f2c12185.js";import{l as ca}from"./vatex-58321dc0.js";import{c as da,a as _a,u as ha,b as ma}from"./vue-router-ac94e6e4.js";import{l as W}from"./lodash-es-f1aaab28.js";import{u as ga}from"./vue-clipboard3-9b4f599e.js";import{u as pa,k as fa}from"./@element-plus-701c722f.js";import{V as Aa}from"./vue-json-pretty-c7b461f1.js";import{B as _l}from"./vue-echarts-ae997641.js";import{C as Ea}from"./color-b12075af.js";import{u as hl,i as ml,a as gl,b as pl,c as fl,d as Al,e as Ia,f as Ta,g as La}from"./echarts-7521af5c.js";import{d as _e,l as Da,a as Nt,b as va,w as Sa}from"./assets-ed5b024e.js";import{X as Na}from"./x2js-8ae16efe.js";import"./async-validator-dee29e8b.js";import"./@vueuse-569d60dd.js";import"./@ctrl-f8748455.js";import"./@sxzz-c75af06c.js";import"./memoize-one-297ddbcb.js";import"./escape-html-099bfe2e.js";import"./@xmldom-8222efe8.js";import"./normalize-wheel-es-ed76fb12.js";import"./katex-32f78592.js";import"./clipboard-77e6e508.js";import"./vue-73d94913.js";import"./resize-detector-a5205554.js";import"./color-string-327061cf.js";import"./color-name-b7949e8c.js";import"./simple-swizzle-d8bc59f1.js";import"./is-arrayish-4445f582.js";import"./color-convert-01838e1d.js";import"./tslib-54e39b60.js";import"./zrender-80a93648.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(s){if(s.ep)return;s.ep=!0;const i=e(s);fetch(s.href,i)}})();const Ye=(_,t)=>{const e=_.__vccOpts||_;for(const[l,s]of t)e[l]=s;return e},ba={};function xa(_,t){const e=vt("router-view");return g(),M(e,null,{default:c(({Component:l})=>[(g(),M(Dl,null,[(g(),M(vl(l)))],1024))]),_:1})}const wa=Ye(ba,[["render",xa]]),Ca="modulepreload",Ra=function(_,t){return new URL(_,t).href},Tl={},ge=function(t,e,l){if(!e||e.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(e.map(i=>{if(i=Ra(i,l),i in Tl)return;Tl[i]=!0;const o=i.endsWith(".css"),r=o?'[rel="stylesheet"]':"";if(!!l)for(let f=s.length-1;f>=0;f--){const x=s[f];if(x.href===i&&(!o||x.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${r}`))return;const m=document.createElement("link");if(m.rel=o?"stylesheet":Ca,o||(m.as="script",m.crossOrigin=""),m.href=i,document.head.appendChild(m),o)return new Promise((f,x)=>{m.addEventListener("load",f),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},Ka=(_,t)=>{const e=_[t];return e?typeof e=="function"?e():Promise.resolve(e):new Promise((l,s)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+t)))})},Kl=[{name:"user",label:"User"},{name:"towers",label:"Towers"},{name:"wolfs",label:"Wolfs"},{name:"umaps",label:"Umaps"},{name:"umapdetail",label:"Umap Detail"},{name:"dmaps",label:"Dream Maps"},{name:"dmap-detail",label:"Dream Map Detail"},{name:"wolf-calc",label:"Wolf Calculation"},{name:"baoxiang",label:"Baoxiang Properties"},{name:"dream-design",label:"Dream Design"},{name:"tower-design",label:"Tower Design"}],Oa=[{path:"/",name:"index",component:()=>ge(()=>Promise.resolve().then(()=>ka),void 0,import.meta.url),children:Kl.map(_=>({path:"/"+_.name,name:_.name,meta:{keepAlive:!0},component:()=>Ka(Object.assign({"../views/sections/baoxiang.vue":()=>ge(()=>Promise.resolve().then(()=>Za),void 0,import.meta.url),"../views/sections/dmap-detail.vue":()=>ge(()=>Promise.resolve().then(()=>Ls),void 0,import.meta.url),"../views/sections/dmaps.vue":()=>ge(()=>Promise.resolve().then(()=>bs),void 0,import.meta.url),"../views/sections/dream-design.vue":()=>ge(()=>Promise.resolve().then(()=>Rs),void 0,import.meta.url),"../views/sections/tower-design.vue":()=>ge(()=>Promise.resolve().then(()=>Bs),void 0,import.meta.url),"../views/sections/towers.vue":()=>ge(()=>Promise.resolve().then(()=>Xs),void 0,import.meta.url),"../views/sections/umapdetail.vue":()=>ge(()=>Promise.resolve().then(()=>ui),void 0,import.meta.url),"../views/sections/umaps.vue":()=>ge(()=>Promise.resolve().then(()=>gi),void 0,import.meta.url),"../views/sections/user.vue":()=>ge(()=>Promise.resolve().then(()=>fi),void 0,import.meta.url),"../views/sections/wolf-calc.vue":()=>ge(()=>Promise.resolve().then(()=>Ci),void 0,import.meta.url),"../views/sections/wolfs.vue":()=>ge(()=>Promise.resolve().then(()=>Xi),void 0,import.meta.url)}),`../views/sections/${_.name}.vue`)}))}],Pa=da({history:_a("/tdsheepvillage-view/"),routes:Oa});const Ol=ea(wa);Ol.use(Pa).use(ca);Ol.mount("#app");const ya={class:"content"},Ma=J({__name:"index",setup(_){const t=ha(),e=ma(),l=ie(""),s=(i,o)=>{t.push({name:i.paneName})};return ta(()=>{l.value=e.name}),(i,o)=>{const r=bl,h=xl,m=vt("router-view");return g(),v("main",null,[n(h,{modelValue:d(l),"onUpdate:modelValue":o[0]||(o[0]=f=>$e(l)?l.value=f:null),type:"card",onTabClick:s},{default:c(()=>[(g(!0),v(k,null,B(d(Kl),f=>(g(),M(r,{key:f.name,label:f.label,name:f.name},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),I("div",ya,[n(m,null,{default:c(({Component:f})=>[(g(),M(Dl,null,[(g(),M(vl(f)))],1024))]),_:1})])])}}});const ka=Object.freeze(Object.defineProperty({__proto__:null,default:Ma},Symbol.toStringTag,{value:"Module"}));function Fa(_,t=!1){t||(_=_.toLowerCase());let e=1315423911;for(let l=_.length-1;l>=0;l--)e^=(e<<5)+_.charCodeAt(l)+(e>>2);return e&2147483647}const Ua=function(_){return/^[a-zA-Z]+$/.test(_)},Va=function(_,t){return _<t?-1:_>t?1:0};function*$a(_){let t=0;for(const e of _)t+=e,yield t}function ke(_){if(_===0)return 1;if(_=Math.abs(_),_%1===0)return Math.pow(10,Math.floor(Math.log10(_)));const t=_.toString();return Math.pow(10,t.indexOf(".")-t.length+1)}function bt(_){return W.mapValues(_,(t,e)=>xt(t,e))}function xt(_,t){return W.mapValues(_,(e,l)=>Ba(e,t,l))}function Ba(_,t,e){return{..._,type:t,id:e}}const b=function(){const _=new Na;let t=_e.camp_system_simple;const e=r=>parseInt(new RegExp("(?<=m).+(?=[A-Z]*)").exec(Ua(r[r.length-1])?r:r+"A")[0],36),l=Object.keys(_e.umaps).sort((r,h)=>Va(e(r),e(h))),s=bt(_e.building),i=bt(_e.skill),o={$_global_language_str:_.xml2dom(Da),$_global_properties:bt(_e.properties),$_skillAtt_Obj:i,$_skillPackage_Obj:_e.skill_package,$_map_Obj:_e.umaps,$_towerAtt_Obj:s.tower,$_bulletAtt_Obj:_e.bullet,$_wolfAtt_Obj:xt(_e.wolfs,"wolf"),$_wallAtt_Obj:s.wall,$_barrierAtt_Obj:_e.barrier,$_level_up_gift:_e.level_up_gift,$_pass_map_gift:_e.pass_map_gift,$Maps:_e.version_ctrl.Maps,$_wolfs_unlock_lv:t.camp_wolf_lv_max_factor,$_wolfs_unlock_gold:t.camp_wolf_gold_max_factor,$_camp_hold_time:t.hold_time,$_camp_pk_cd_time:t.pk_cd_time,$_camp_pk_times_max:t.pk_times_max,$_camp_defend_times_max:t.defend_times_max,$_camp_pk_arena_times_max:t.pk_arena_times_max,$_camp_defend_arena_times_max:t.defend_arena_times_max,$_camp_mining_rate:t.mine_rate,$_camp_sell_building_dis:t.sell_building_dis,$_tower_worth_factor:t.tower_worth_factor,$_wolf_worth_factor:t.wolf_worth_factor,$_defend_map_snarp_max:t.defend_map_snarp_max,$_defend_succ_factor:t.defend_succ_factor,$_defend_failed_factor:t.defend_failed_factor,$_defend_arena_succ_factor:t.defend_arena_succ_factor,$_defend_arena_failed_factor:t.defend_arena_failed_factor,$_conflict_skill_kind:t.conflict_skill_kind,$_skill_lvup_spend:t.skill_lvup_spend,$_skill_grade_score:t.skill_grade_score,$_camp_use_exp_wolf_max:t.use_exp_wolf_max,$_camp_use_exp_tower_max:t.use_exp_tower_max,$_camp_wolf_lv_max:t.wolf_lv_max,$_camp_need_user_level:t.camp_need_user_level,$_camp_arena_need_user_level:t.arena_need_user_level,$_camp_create_mine_help_max:t.create_mine_help_max,$_camp_create_mine_help_friends_num:t.create_mine_help_friends_num,$_dream_wolf_hard_ness:Nt.dm_wolf_hard_ness,umapsById:l.map(r=>[r,_e.umaps[r]]),dream_data:Nt,dream_maps:xt(Nt.dmaps,"dmaps"),dream_waves:va,skillTemplates:W.chain(Object.values(i.towerSkill)).groupBy(r=>r.kindId).mapValues(r=>({id:r[0].id,params:r[0].params})).value()};return console.log("init",o.umapsById),o}(),ht=_=>W.mapValues(_,t=>{let e=t.name;return e.includes("^")?e.substring(e.indexOf("^")+1):e}),wt=Object.assign({},ht(b.$_map_Obj),ht(b.$_wolfAtt_Obj),ht(b.$_towerAtt_Obj),...Object.values(b.$_global_properties).map(_=>ht(_)));console.log("dict",wt);function De(_){return typeof _=="string"?wt[_]:_.map(t=>wt[t])}const Ha={key:0},Ga={key:0},Wa={class:"ml-4"},ja={key:1},Xa={key:1},Ya={key:0},za={key:1},qa={class:"ml-4"},Ja=J({__name:"baoxiang",setup(_){const t=W.chain(b.$_global_properties.card).values().filter(e=>e.id.startsWith("baoxiang")).sortBy(e=>Math.abs(e.index)).value();return(e,l)=>{const s=Ge,i=nt,o=We;return g(),v("div",null,[n(o,{data:d(t),style:{"font-size":"small"}},{default:c(()=>[n(s,{label:"id",prop:"id",width:120}),n(s,{label:"name",prop:"name",width:160}),n(s,{label:"open_num",prop:"open_num",width:100}),n(s,{label:"info",prop:"info",width:400}),n(s,{label:"data"},{default:c(r=>[r.row.default_gift?(g(),v("ul",Ha,[(g(!0),v(k,null,B(r.row.default_gift,(h,m)=>(g(),v(k,{key:m},[String(m)=="properties"?(g(),v("li",Ga,[n(i,{type:"warning"},{default:c(()=>[N(T(m),1)]),_:2},1024),I("ul",Wa,[(g(!0),v(k,null,B(h,(f,x)=>(g(),v("li",{key:x},[n(i,null,{default:c(()=>[N(T(x),1)]),_:2},1024),(g(!0),v(k,null,B(f,(w,D)=>(g(),M(i,{key:D,type:"info",title:D},{default:c(()=>[N(T(d(De)(String(D)))+": "+T(w),1)]),_:2},1032,["title"]))),128))]))),128))])])):(g(),v("li",ja,[n(i,{type:"warning"},{default:c(()=>[N(T(m),1)]),_:2},1024),n(i,{type:"info"},{default:c(()=>[N(T(h),1)]),_:2},1024)]))],64))),128))])):pe("",!0),r.row.data?(g(),v("ul",Xa,[(g(!0),v(k,null,B(r.row.data,h=>(g(),v(k,{key:h[0]},[h[1]=="invite_score"?(g(),v("li",Ya,[n(i,{type:"success"},{default:c(()=>[N(T(h[0]),1)]),_:2},1024),n(i,{type:"warning"},{default:c(()=>[N(T(h[1]),1)]),_:2},1024),n(i,null,{default:c(()=>[N(T(h[2]),1)]),_:2},1024)])):pe("",!0),h[1]=="properties"?(g(),v("li",za,[n(i,{type:"success"},{default:c(()=>[N(T(h[0]),1)]),_:2},1024),n(i,{type:"warning"},{default:c(()=>[N(T(h[1]),1)]),_:2},1024),I("ul",qa,[(g(!0),v(k,null,B(h[2],m=>(g(),v("li",{key:m[0]},[n(i,{type:"success"},{default:c(()=>[N(T(m[0]),1)]),_:2},1024),n(i,{type:"warning"},{default:c(()=>[N(T(m[1]),1)]),_:2},1024),n(i,null,{default:c(()=>[(g(!0),v(k,null,B(m[2],f=>(g(),M(i,{title:f,type:"info",key:f},{default:c(()=>[N(T(d(De)(f)),1)]),_:2},1032,["title"]))),128))]),_:2},1024)]))),128))])])):pe("",!0)],64))),128))])):pe("",!0)]),_:1})]),_:1},8,["data"])])}}}),Za=Object.freeze(Object.defineProperty({__proto__:null,default:Ja},Symbol.toStringTag,{value:"Module"})),he=class he{static formatTime(t,e=!1){let l=t%60,s=Math.floor(t/60)%60,i=Math.floor(t/3600),o="";if(e){if(i>0)return o=i.toString()+u.getLanguageStr(21),o+(s.toString()+u.getLanguageStr(22));if(s>0)return o+=s.toString()+u.getLanguageStr(22),o+(l.toString()+u.getLanguageStr(23));l>=0&&(o+=l.toString()+u.getLanguageStr(23))}else i>=0&&(o=(i>9?i.toString():"0"+i.toString())+":"),s>=0&&(o+=(s>9?s.toString():"0"+s.toString())+":"),l>=0&&(o+=Math.floor(l)>9?Math.floor(l).toString():"0"+Math.floor(l).toString());return o}static formatTime_day(t){let e=Math.floor(t/3600),l=Math.floor(e/24),s=Math.ceil(t/60)%60,i=e%24,o="";return l>0&&(o=l.toString()+u.getLanguageStr(20)),i>0&&(o+=i.toString()+u.getLanguageStr(21)),s>0&&(o+=s.toString()+u.getLanguageStr(22)),o}static formatTime_M(t,e=!1){let l=Math.floor(t/60)%60,s=Math.floor(t/3600),i="";return e?s>0?(i=s.toString()+u.getLanguageStr(21),i+(l.toString()+u.getLanguageStr(22))):l>0?i+(l.toString()+u.getLanguageStr(22)):u.getLanguageStr(24):(s>=0&&(i=s.toString()+":"),l>=0&&(i+=l.toString()+":"),i)}static getElementNum(t){let e,l=0;for(e in t)l++;return l}static randomElement(t){let e,l=0,s=he.getElementNum(t),i=Math.floor(Math.random()*s);for(e of t){if(l==i)return e;l++}return null}static formatHtmlText_normal(t,e=10,l=3355443,s=""){return he.formatHtmlText(t,l,!1,14,s,e)}static getSimpleNumStr(t,e=!1){let l;return t>1e4?(l=e?u.getLanguageStr(116):u.getLanguageStr(108),Math.round(t/1e4)+l):String(t)}static getValueByIndex(t,e){for(const l in e)if(l!=he.DEFAULT){const s=he.getIDPos(l);if(t>=s.x&&t<=s.y)return e[l]}return e[he.DEFAULT]??1}static getIDPos(t){var e=t.indexOf("_");return{x:parseInt(t.slice(0,e)),y:parseInt(t.slice(e+1,t.length))}}static fillSpace(t,e=10,l=!0){let s=0,i=0,o=0,r=0,h="";for(i=0;i<t.length;i++)o=t.charCodeAt(i),o>=32&&o<=126?s=1:s=2,r+=s;for(i=r;i<e;i++)h+=" ";return l?h+=t:h=t+h,h}static formatHtmlText(t,e=3355443,l=!1,s=14,i="",o=12,r=null){let h="",m="",f="#"+e.toString(16);return o<1e3?(h=t,m=he.formatLine(h,`
`,o*2,r)):m=t,l?'<font color="'+f+'" size="'+s+'" face="'+i+'"><b>'+m+"</b></font>":'<font color="'+f+'" size="'+s+'" face="'+i+'">'+m+"</font>"}static getLine(t=40,e="=",l="",s=5){let i=0,o="";for(e==""&&(e="="),l==""&&(l="left"),i=0;i<t;i++)o+=e;return HtmlTextFormat.format(o,l,6316128,s)}static formatHtmlTextBr(t,e="left"){let l="";for(let s=0;s<t.length;s++)l+='<P ALIGN="'+e+'">'+t[s]+"</P>";return l}static formatLine(t,e=`
`,l=16,s=null){let i=0,o=0,r=0,h=null,m="",f=0;for(s==null&&(s=[]),l<=1&&(l=2),i=0;i<t.length;i++)r=t.charCodeAt(i),h=t.charAt(i),h==`
`?(f=0,m+=h):(s.indexOf(h)!=-1?o=0:r>=32&&r<=126?o=1:o=2,f+=o,f>l&&(m+=e,f=o),m+=h);return m}static clearLine(t){return t=t.replace(`
`,""),t=t.replace("<br>",""),t.replace("</br>","")}static isHtml(t){let e=t.indexOf("<"),l=t.indexOf(">");return e!=-1&&l!=-1&&e<l}static insertStr(t,e=`
`,l=4,s=1){let i="",o="",r=0;for(s<=0&&(s=int.MAX_VALUE),l<=0&&(l=1);r<s;)o=t.substr(r*l,l),r++,o.length!=l&&(i+=o),o+=e,i+=o;return i+t.substr(r*l)}static getGlobalAttValue_byID(t,e=0){return t["id_"+e]}static setObjAttributeValue(t,e,l){for(let s=0;s<e.length;s++)t[e[s][l]]=e[s];return t}static getObjAttributeValue(t,e){return t[e]==null&&t[e]==null?null:t[e]}static isNullAndUndefined(t){return t==null||t==null}static isNullForArray(t){return!(t!=null&&t.length>0)}static addObjectNewAtt(t,e){let l=null;if(!he.isNullAndUndefined(e))for(l in e)t[l]=e[l];return t}static isSameDate(t,e){return!t||!e?!1:t.getUTCFullYear()==e.getUTCFullYear()&&t.getUTCMonth()==e.getUTCMonth()&&t.getUTCDate()==e.getUTCDate()}static getRandom(t,e){let l=0;return t==e?t:(t>e&&(l=t,t=e,e=l),l=e-t+1,Math.floor(t+Math.random()*l))}static replaceString(t,e,l){let s=new RegExp(e,"g");return t.replace(s,l)}static getDateSecond(t){return Math.floor(t.getTime()*.001)}static isNoChildrenInArr(t){let e=!1;return t!=null&&t.length>0?e=!1:e=!0,e}static isNoChildrenInObj(t){let e=0,l=null,s=!0;if(t){e=0;for(l in t)e++;e>0&&(s=!1)}return s}static toString(t,e=0,l=!1){let s=0,i=0,o=null,r="";if(e++,t==null)return"null";let h=typeof t,m=0;switch(h){case"number":return t.toString()+"";case"string":return'"'+t+'"';case"object":if(t instanceof Array){if(m=he.getElementNum(t),m>1)for(e>1&&(r+=`
`),i=0;i<e-1;i++)r+="	";for(r+="[",s=0;s<t.length;s++){if(m>1)for(r+=`
`,i=0;i<e;i++)r+="	";r+=toString(t[s],e),r+=","}if(m>0&&(r=r.slice(0,r.length-1)),m>1)for(r+=`
`,i=0;i<e-1;i++)r+="	";r+="]"}else if(t instanceof Date)r="new Date("+t.getTime()+")";else{if(m=he.getElementNum(t),m>1)for(e>1&&(r+=`
`),i=0;i<e-1;i++)r+="	";r+="{";for(o in t){if(m>1)for(r+=`
`,i=0;i<e;i++)r+="	";!isNaN(Number(o.slice(0,1)))||o.search(/[^a-zA-Z0-9_]/)!=-1?r+='"'+o+'":'+he.toString(t[o],e):r+=o+":"+he.toString(t[o],e),r+=","}if(m>0&&(r=r.slice(0,r.length-1)),m>1)for(r+=`
`,i=0;i<e-1;i++)r+="	";r+="}"}break;case"boolean":return t.toString()+""}return r}static getTodayEndUTCTime(t){return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),23,59,59)}static replaceAllBySplit(t,e,l){return t==null?null:t.split(e).join(l)}static formatNumberToString(t){let e;return t>=1e3&&t<=9999?(t=Math.floor(t*.001),e=t.toString()+"千"):t>=1e4?(t=Math.floor(t*1e-4),e=t.toString()+"万"):e=t.toString(),e}};a(he,"DEFAULT","default");let Ct=he;const qe=class qe{static getLanguageStr(t,...e){let l=null,s=null,i="";if(b.$_global_language_str!=null&&(b.$_global_language_str.getElementsByTagName("id"+t)[0]!=null?b.$_global_language_str.getElementsByTagName("id"+t)[0].getAttribute("str")=="CHILD2010"?i=b.$_global_language_str.getElementsByTagName("id"+t)[0].children().toString():i=b.$_global_language_str.getElementsByTagName("id"+t)[0].getAttribute("str"):i=null),i.length<=0)return"";let o=i.search("%%");for(;o!=-1;)s=i.slice(o,o+6),i=i.replace(s,qe.getLanguageStr(parseInt(s.slice(2)))),o=i.search("%%");for(let r=0;r<e.length;r++)l="%"+r,i=Ct.replaceString(i,l,e[r]);return i}static getDataProfileTxt(t){let e=null,l=!1,s=null,i=null,o=null,r=t;return t&&(e=String(t),l=e.indexOf(qe.INTER_CONFIG_SPLIT_CHAR)>-1,s=null,i="",o="",l?(s=e.split(qe.INTER_CONFIG_SPLIT_CHAR),i=s[0],o=s[1],b.$_global_dataProfile_txt!=null?(b.$_global_dataProfile_txt.getElementsByTagName(i)[0]!=null?r=b.$_global_dataProfile_txt.getElementsByTagName(i)[0].getAttribute("s").toString():r=o,r=r.replace(/\\n/g,`
`)):r=o):r=e,s=null,e="",i="",o=""),r}};a(qe,"INTER_CONFIG_SPLIT_CHAR","^");let u=qe;const oe=class oe{constructor(t){a(this,"typeId");a(this,"kindId");a(this,"id");a(this,"name");a(this,"info");a(this,"help");this.typeId=t[oe.DATA_TYPE_ID],this.kindId=t[oe.DATA_KIND_ID],this.id=t[oe.DATA_ID],this.name=u.getDataProfileTxt(t[oe.DATA_NAME]),this.info=u.getDataProfileTxt(t[oe.DATA_INFO]),this.help=t[oe.DATA_HELP]?u.getDataProfileTxt(t[oe.DATA_HELP]):""}};a(oe,"DATA_TYPE_ID","typeId"),a(oe,"DATA_KIND_ID","kindId"),a(oe,"DATA_ID","id"),a(oe,"DATA_NAME","name"),a(oe,"DATA_INFO","info"),a(oe,"DATA_HELP","help");let de=oe;const Z=class Z extends de{constructor(e){super(e);a(this,"res");a(this,"resColor");e[Z.DATA_RESOURCE_CLASS]==null?this.res=e[de.DATA_ID]:this.res=e[Z.DATA_RESOURCE_CLASS],this.resColor=e[Z.DATA_RESOURCE_COLOR_CLASS]}};a(Z,"TYPE_MONSTER","wolf"),a(Z,"TYPE_TOWER","tower"),a(Z,"TYPE_WALL","wall"),a(Z,"TYPE_BARRIER","barrier"),a(Z,"TYPE_ENTRANCE","typeEntrance"),a(Z,"TYPE_EXPORT","typeExport"),a(Z,"TYPE_BOX","box"),a(Z,"TYPE_GEM_ITEM","gem"),a(Z,"TYPE_TRAP_ITEM","snarp"),a(Z,"TYPE_CARD_ITEM","card"),a(Z,"TYPE_WOLF_CARD_ITEM","wc"),a(Z,"TYPE_TAME_ITEM","tame"),a(Z,"TYPE_FIX_ITEM","bomb"),a(Z,"ID_SPADE_ITEM","mc"),a(Z,"ID_GEM_HAMMER","gem_hammer"),a(Z,"ID_GEM_OPENER","gem_opener"),a(Z,"DATA_RESOURCE_CLASS","res"),a(Z,"DATA_RESOURCE_COLOR_CLASS","resColor");let ve=Z;class ze{constructor(){a(this,"m_manager",{});this.clearData()}getDataById(t){return this.m_manager[t]}get manager(){return this.m_manager}clearData(){this.m_manager=new Object}}class dt{constructor(){a(this,"m_data");this.m_data=new de({})}get baseData(){return this.m_data}}class Qa extends dt{constructor(){super()}}const H=class H extends ve{constructor(e){super(e);a(this,"scoreMax");a(this,"populationMax");a(this,"hardA");a(this,"hardB");a(this,"passBy");a(this,"unkennelDelay");a(this,"unkennelRule");a(this,"bossList");a(this,"monsterList");a(this,"teleportRule");this.scoreMax=e[H.DATA_SCORE_MAX]?e[H.DATA_SCORE_MAX]:H.DEFAULT_SCORE_MAX,this.populationMax=e[H.DATA_POPULATION_MAX]?e[H.DATA_POPULATION_MAX]:H.DEFAULT_POPULATION_MAX,this.hardA=e[H.DATA_HARD_A],this.hardB=e[H.DATA_HARD_B],this.passBy=e[H.DATA_PASS_BY],this.unkennelDelay=e[H.DATA_UNKENNEL_RATE],this.unkennelRule=e[H.DATA_UNKENNEL_RULE],this.bossList=e[H.DATA_BOSS_LIST],this.monsterList=e[H.DATA_MONSTER_LIST]?e[H.DATA_MONSTER_LIST].map(l=>l[1]):[],this.teleportRule=e[H.DATA_TELEPORT_RULE]}getDifficultyLevel(e){return Math.sqrt(this.hardA+this.hardB*e)}};a(H,"DEFAULT_SCORE_MAX",100),a(H,"DEFAULT_POPULATION_MAX",10),a(H,"RULE_MULTICAST",1),a(H,"DATA_SCORE_MAX","pass_score"),a(H,"DATA_POPULATION_MAX","pop_max"),a(H,"DATA_HARD_A","yield_val"),a(H,"DATA_HARD_B","hard_ness"),a(H,"DATA_PASS_BY","passBy"),a(H,"DATA_UNKENNEL_RATE","interval"),a(H,"DATA_UNKENNEL_RULE","interval_rule"),a(H,"DATA_BOSS_LIST","boss"),a(H,"DATA_MONSTER_LIST","wolf_proportion"),a(H,"DATA_TELEPORT_RULE","teleport_rule"),a(H,"DATA_DEBUG","debug");let Rt=H;const Ie=class Ie extends ze{constructor(){super(),Ie.onlyExample=this,this.loadData(b.$_map_Obj)}static getOnlyExample(){return Ie.onlyExample==null&&(Ie.onlyExample=new Ie),Ie.onlyExample}loadData(t){for(const e in t){const l=t[e];l[de.DATA_ID]=e,this.m_manager[e]=new Rt(t[e])}}getData(t){return this.getDataById(t)}};a(Ie,"DATA_COUNT",6),a(Ie,"onlyExample");let pt=Ie;class ee extends dt{constructor(e,l=!0){super();a(this,"score",0);a(this,"isDream",!1);this.m_data=pt.getOnlyExample().getData(e)}static getMapData(e){return pt.getOnlyExample().getData(e)}get gameMapData(){return this.m_data}get canUnkennelAdjust(){return!1}}a(ee,"DEFEND_MAP_1","mfx1"),a(ee,"ENDLESS_MAP_1","m11"),a(ee,"currentMap");function es(_,t){let e=_.toFixed(8),l=e.indexOf(".");return l==-1||e.length-l-1<=t?e:_.toFixed(t).replace(/\.?0+$/,"")}function Kt(_,t=0,e=!1,l="14",s=""){return`<span style="color:#${t.toString(16).padStart(6,"0")};${e?"font-weight:bold;":""}${l?`font-size:${l};`:""}${s?`font-family:${s};`:""}">${_.replaceAll(`
`,"<br>")}</span>`}function ts(_){return Math.floor(_/3600)+":"+Math.floor(_/60%60).toString().padStart(2,"0")+":"+(_%60).toString().padStart(2,"0")}class $ extends ve{constructor(t){super(t)}}a($,"KIND_HIT","hit"),a($,"KIND_INVASION","invasion"),a($,"KIND_TELEPORT","teleport"),a($,"KIND_BUFF_TOP","buffTop"),a($,"KIND_BUFF_MID","buffMid"),a($,"KIND_BUFF_BOT","buffBot"),a($,"KIND_MAGIC","effectMagic"),a($,"KIND_PATH","effectPath"),a($,"KIND_CRIT","effectCrit"),a($,"KIND_SUMMON","effectSummon"),a($,"KIND_CLOUD","effectCloud"),a($,"KIND_MIRROR","effectMirror"),a($,"KIND_CURE","effectCure"),a($,"KIND_CURE_ONE","effectCureOne"),a($,"KIND_SNEER","effectSneer"),a($,"KIND_LINKS","effectLinks"),a($,"KIND_RELIVE","effectRelive"),a($,"KIND_SUICIDE","effectSuicide"),a($,"KIND_BLINK_IN","effectBlinkIn"),a($,"KIND_BLINK_OUT","effectBlinkOut"),a($,"KIND_LIGHTNING","lightning"),a($,"KIND_FIELD_ATTACK","allAttack"),a($,"KIND_FIELD_ATTACK_AOE","allAttackAOE"),a($,"KIND_CUSS","effectCuss"),a($,"KIND_CUSS_BREAK","effectCussBreak"),a($,"KIND_SIGN_SUMMON","signSummon"),a($,"KIND_SIGN_CURE","signCure"),a($,"KIND_SIGN_CLOUD","signCloud"),a($,"KIND_SIGN_SHIELD","signShield"),a($,"KIND_SIGN_TRANSFORM","signTransform"),a($,"KIND_BOSS","effectBoss");const Ne=class Ne extends ve{constructor(e){super(e);a(this,"parameter");a(this,"levels");this.parameter=e[Ne.DATA_PARAMETER],this.levels=e[Ne.DATA_LEVELS]}getLevelParam(e,l){return this.parameter!=null?this.parameter[l]:this.levels!=null?(e=Math.min(Math.max(0,e-1),this.levels.length-1),this.levels[e][l]):null}hasLevel(){return this.parameter==null}};a(Ne,"TYPE_TOWER_SKILL","typeTowerSkill"),a(Ne,"TYPE_MONSTER_SKILL","typeMonsterSkill"),a(Ne,"DATA_PARAMETER","params"),a(Ne,"DATA_LEVELS","levels");let He=Ne;class L extends He{constructor(t){super(t),t[de.DATA_TYPE_ID]=He.TYPE_TOWER_SKILL}}a(L,"KIND_AURA","Aura"),a(L,"KIND_CHANGE_BULLET","Bultype"),a(L,"KIND_CHANGE_DAMAGE","ChangeDam"),a(L,"KIND_CHANGE_RATE","ChangeRate"),a(L,"KIND_CHANGE_RANGE","ChangeRange"),a(L,"KIND_FIELD_ATTACK","ALLAP"),a(L,"KIND_DIVIDED_ATTACK","DivAP"),a(L,"KIND_SCATTER_ATTACK","ScaAP"),a(L,"KIND_COMBO_ATTACK","ComAP"),a(L,"KIND_GUIDED_BULLET","GuidedBul"),a(L,"KIND_ATTACK_RATE","AttackRate"),a(L,"KIND_AOE_ATTACK","AoeAP"),a(L,"KIND_THROUGHOUT_ATTACK","ThoAP"),a(L,"KIND_BOUNCE_ATTACK","BouAP"),a(L,"KIND_FLOAT_DAMAGE","FloatDam"),a(L,"KIND_CRIT","Crit"),a(L,"KIND_REDUCED_DEFENSE","RedDef"),a(L,"KIND_POISON","Poison"),a(L,"KIND_SLOW","Slow"),a(L,"KIND_BURN_COLD","BC"),a(L,"KIND_BEAT_BACK","Beat"),a(L,"KIND_SILENCE","Silence"),a(L,"KIND_VERTIGO","Vertigo"),a(L,"KIND_INTIMIDATE","Intimidate"),a(L,"KIND_CUSS","Cuss"),a(L,"KIND_BURN","Burn"),a(L,"KIND_COLD","Cold");const A=class A extends He{constructor(t){super(t),t[de.DATA_TYPE_ID]=He.TYPE_MONSTER_SKILL}static get allMonsterSkill(){return[A.KIND_FLY,A.KIND_AIRBORNE,A.KIND_ISOLATION,A.KIND_RELIVE,A.KIND_SUICIDE,A.KIND_REINCARNATE,A.KIND_RESIST_FIRE,A.KIND_RESIST_FROST,A.KIND_RESIST_POISON,A.KIND_RESIST_BEAT,A.KIND_RESIST_SILENCE,A.KIND_RESIST_VERTIGO,A.KIND_RESIST_CRIT,A.KIND_RESIST_LIGHT,A.KIND_RESIST_STRSMOOTH,A.KIND_SLOWF,A.KIND_WEAK_FIRE,A.KIND_WEAK_FROST,A.KIND_WEAK_POISON,A.KIND_WEAK_BEAT,A.KIND_WEAK_SILENCE,A.KIND_WEAK_VERTIGO,A.KIND_WEAK_CRIT,A.KIND_WEAK_LIGHT,A.KIND_RUN,A.KIND_MIRROR,A.KIND_SUMMON,A.KIND_CLOUD,A.KIND_CURE,A.KIND_BLINK,A.KIND_HIDE,A.KIND_SHIELD,A.KIND_SNEER,A.KIND_TRANSFORM,A.KIND_LINKS]}};a(A,"EVENT_RED",1),a(A,"EVENT_YELLOW",2),a(A,"EVENT_GREEN",3),a(A,"EVENT_FULL",4),a(A,"EVENT_INTIMIDATE",20),a(A,"EVENT_VERTIGO",21),a(A,"EVENT_SILENCE",22),a(A,"EVENT_SLOW",23),a(A,"EVENT_REDUCED_DEFENSE",24),a(A,"EVENT_POISON",25),a(A,"EVENT_BURN",26),a(A,"EVENT_COLD",27),a(A,"EVENT_HIT",40),a(A,"EVENT_CRIT",41),a(A,"EVENT_BEAT_BACK",42),a(A,"EVENT_FRIENT_DIE",43),a(A,"EVENT_DIE",44),a(A,"KIND_FLY","fly"),a(A,"KIND_AIRBORNE","airborne"),a(A,"KIND_ISOLATION","isolation"),a(A,"KIND_RELIVE","revive"),a(A,"KIND_SUICIDE","burst"),a(A,"KIND_REINCARNATE","reborn"),a(A,"KIND_SLOWF","slowf"),a(A,"KIND_RESIST_FIRE","resistFire"),a(A,"KIND_RESIST_FROST","resistFrost"),a(A,"KIND_RESIST_POISON","resistPoison"),a(A,"KIND_RESIST_SLOW","resistSlow"),a(A,"KIND_RESIST_BEAT","resistBeat"),a(A,"KIND_RESIST_SILENCE","resistSilence"),a(A,"KIND_RESIST_VERTIGO","resistVertigo"),a(A,"KIND_RESIST_CRIT","resistCrit"),a(A,"KIND_RESIST_LIGHT","resistLight"),a(A,"KIND_RESIST_INTIMIDATE","resistIntimidate"),a(A,"KIND_WEAK_FIRE","weakFire"),a(A,"KIND_WEAK_FROST","weakFrost"),a(A,"KIND_WEAK_POISON","weakPoison"),a(A,"KIND_WEAK_SLOW","weakSlow"),a(A,"KIND_WEAK_BEAT","weakBeat"),a(A,"KIND_WEAK_SILENCE","weakSilence"),a(A,"KIND_WEAK_VERTIGO","weakVertigo"),a(A,"KIND_WEAK_CRIT","weakCrit"),a(A,"KIND_WEAK_LIGHT","weakLight"),a(A,"KIND_WEAK_INTIMIDATE","weakIntimidate"),a(A,"KIND_RESIST_STRSMOOTH","strsmooth"),a(A,"KIND_RUN","sprint"),a(A,"KIND_MIRROR","divide"),a(A,"KIND_SUMMON","summon"),a(A,"KIND_CLOUD","cloud"),a(A,"KIND_CURE","massTreatment"),a(A,"KIND_BLINK","blink"),a(A,"KIND_HIDE","invisible"),a(A,"KIND_SHIELD","shield"),a(A,"KIND_SNEER","taunt"),a(A,"KIND_TRANSFORM","morph"),a(A,"KIND_LINKS","links");let p=A;const ue=class ue extends ze{constructor(){super(),ue.onlyExample=this,this.loadData(b.$_skillAtt_Obj)}static getOnlyExample(){return ue.onlyExample==null&&(ue.onlyExample=new ue),ue.onlyExample}loadData(t){for(const e in t[ue.TOWER_SKILL]){const l=t[ue.TOWER_SKILL][e];l[de.DATA_ID]=e,this.m_manager[e]=new L(l)}for(const e in t[ue.MONSTER_SKILL]){const l=t[ue.MONSTER_SKILL][e];l[de.DATA_ID]=e,this.m_manager[e]=new p(l)}}getData(t){return this.getDataById(t)}};a(ue,"onlyExample"),a(ue,"TOWER_SKILL","towerSkill"),a(ue,"MONSTER_SKILL","monsterSkill"),a(ue,"TRAP_SKILL","trapSkill");let Ot=ue;const Fe=class Fe extends de{constructor(e){super(e);a(this,"skillsList");e[Fe.DATA_SKILLS_LIST]instanceof Array?this.skillsList=e[Fe.DATA_SKILLS_LIST]:e[Fe.DATA_SKILLS_LIST]instanceof String&&(this.skillsList=[e[Fe.DATA_SKILLS_LIST]])}};a(Fe,"DATA_SKILLS_LIST","skills");let Pt=Fe;const be=class be extends ze{constructor(){super(),be.onlyExample=this,this.loadData(b.$_skillPackage_Obj)}static getOnlyExample(){return be.onlyExample==null&&(be.onlyExample=new be),be.onlyExample}loadData(t){for(const e in t){const l=t[e];l[de.DATA_ID]=e,this.m_manager[e]=new Pt(t[e])}}getData(t){return this.getDataById(t)}};a(be,"onlyExample");let yt=be;class P{static toPercentage(t){return String(Math.round(t*100*100)/100)+"%"}static toGridStr(t){return String(Math.round(t/100)/10)}static getPosID(t,e){return t+"_"+e}}class Pl extends dt{constructor(e,l,s=!1){super();a(this,"level",0);a(this,"index",0);a(this,"enabled",!0);a(this,"m_skillInfo","");a(this,"m_nextLevelSkillInfo","");a(this,"skillTag1","");a(this,"skillTag2","");a(this,"skillTag3","");a(this,"nextLevelSkillTag1","");a(this,"nextLevelSkillTag2","");a(this,"nextLevelSkillTag3","");a(this,"m_updateFunction",()=>{});if(s){this.m_data=new At({id:e+"_0",kindId:e});return}this.m_data=Ot.getOnlyExample().getData(e),this.level=l,this.enabled=!0}get data(){return this.m_data}get skillInfo(){return this.m_updateFunction!=null&&this.m_updateFunction(),this.m_skillInfo||(this.m_skillInfo=""),this.m_skillInfo}get nextLevelSkillInfo(){return this.m_nextLevelSkillInfo||(this.m_nextLevelSkillInfo=""),this.m_nextLevelSkillInfo}}class j extends Pl{constructor(e,l,s){super(e,l);a(this,"tower");this.tower=s}static create(e,l,s){const i=new j("",l,s);return i.m_data=e,i}shouldTransferBullet(){switch(this.data.kindId){case L.KIND_GUIDED_BULLET:case L.KIND_ATTACK_RATE:case L.KIND_AOE_ATTACK:case L.KIND_THROUGHOUT_ATTACK:case L.KIND_BOUNCE_ATTACK:case L.KIND_FLOAT_DAMAGE:case L.KIND_CRIT:case L.KIND_REDUCED_DEFENSE:case L.KIND_POISON:case L.KIND_SLOW:case L.KIND_BURN_COLD:case L.KIND_BEAT_BACK:case L.KIND_SILENCE:case L.KIND_VERTIGO:case L.KIND_INTIMIDATE:case L.KIND_CUSS:return!0;default:return!1}}getSubClasses(){switch(this.data.kindId){case L.KIND_AURA:return new kt(this.data.id,this.level,this.tower);case L.KIND_CHANGE_BULLET:return new yl(this.data.id,this.level,this.tower);case L.KIND_CHANGE_DAMAGE:return new Ml(this.data.id,this.level,this.tower);case L.KIND_CHANGE_RATE:return new Fl(this.data.id,this.level,this.tower);case L.KIND_CHANGE_RANGE:return new kl(this.data.id,this.level,this.tower);case L.KIND_FIELD_ATTACK:return new Wt(this.data.id,this.level,this.tower);case L.KIND_DIVIDED_ATTACK:return new Ht(this.data.id,this.level,this.tower);case L.KIND_SCATTER_ATTACK:return new Yt(this.data.id,this.level,this.tower);case L.KIND_COMBO_ATTACK:return new Vt(this.data.id,this.level,this.tower);case L.KIND_GUIDED_BULLET:return new is(this.data.id,this.level,this.tower);case L.KIND_ATTACK_RATE:return new ls(this.data.id,this.level,this.tower);case L.KIND_AOE_ATTACK:return new Mt(this.data.id,this.level,this.tower);case L.KIND_THROUGHOUT_ATTACK:return new Jt(this.data.id,this.level,this.tower);case L.KIND_BOUNCE_ATTACK:return new Ut(this.data.id,this.level,this.tower);case L.KIND_FLOAT_DAMAGE:return new ss(this.data.id,this.level,this.tower);case L.KIND_CRIT:return new $t(this.data.id,this.level,this.tower);case L.KIND_REDUCED_DEFENSE:return new Xt(this.data.id,this.level,this.tower);case L.KIND_POISON:return new jt(this.data.id,this.level,this.tower);case L.KIND_SLOW:return new qt(this.data.id,this.level,this.tower);case L.KIND_BURN_COLD:return new as(this.data.id,this.level,this.tower);case L.KIND_BEAT_BACK:return new Ft(this.data.id,this.level,this.tower);case L.KIND_SILENCE:return new zt(this.data.id,this.level,this.tower);case L.KIND_VERTIGO:return new Zt(this.data.id,this.level,this.tower);case L.KIND_INTIMIDATE:return new Gt(this.data.id,this.level,this.tower);case L.KIND_CUSS:return new Bt(this.data.id,this.level,this.tower);default:return this}}}const xe=class xe extends j{constructor(t,e,l){super(t,e,l),this.index=1050,this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3001,this.radiiInfo,P.toPercentage(this.nextEffectRate))}}get radii(){return this.data.getLevelParam(this.level,0)+xe.DEFAULT_RADII}get nextEffectRate(){return Math.min(this.data.getLevelParam(this.level,1)+xe.DEFAULT_NEXT_EFFECT_RATE,xe.MAX_NEXT_EFFECT_RATE)}get radiiInfo(){return this.radii.toString()}};a(xe,"DEFAULT_RADII",0),a(xe,"DEFAULT_NEXT_EFFECT_RATE",0),a(xe,"MAX_NEXT_EFFECT_RATE",1);let Mt=xe;class ls extends j{constructor(t,e,l){super(t,e,l),this.index=1040,this.m_updateFunction=()=>{let s=this.floorRate,i=this.airRate;s<=0&&i>0?this.m_skillInfo=u.getLanguageStr(3029):i<=0&&s>0?this.m_skillInfo=u.getLanguageStr(3028):s!=1?this.m_skillInfo=u.getLanguageStr(3030,P.toPercentage(s)):i!=1&&(this.m_skillInfo=u.getLanguageStr(3031,P.toPercentage(i)))}}get floorRate(){return this.data.getLevelParam(this.level,0)}get airRate(){return this.data.getLevelParam(this.level,1)}}const It=class It extends j{constructor(t,e,l){super(t,e,l),this.index=1500,this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3002)}}get spId(){return this.data.getLevelParam(this.level,0)}get spLevel(){return this.data.getLevelParam(this.level,1)}get radii(){return this.data.getLevelParam(this.level,2)*this.level+It.DEFAULT_RADII}};a(It,"DEFAULT_RADII",1e3);let kt=It;const Ue=class Ue extends j{constructor(t,e,l){super(t,e,l),this.index=1060,this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3003,P.toPercentage(this.chances),this.distanceInfo)}}get chances(){return Math.max(Math.min(this.data.getLevelParam(this.level,0)*this.level+Ue.DEFAULT_CHANCES,1),0)}get beatBackDistance(){return this.data.getLevelParam(this.level,1)+Ue.DEFAULT_BEAT_BACK_DISTANCE}get distanceInfo(){return this.beatBackDistance.toString()}};a(Ue,"SHIFT_TIME",.2),a(Ue,"DEFAULT_CHANCES",0),a(Ue,"DEFAULT_BEAT_BACK_DISTANCE",0);let Ft=Ue;const Te=class Te extends j{constructor(t,e,l){super(t,e,l),this.index=1070,this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3004,this.bounceNum,P.toPercentage(1-this.nextEffectRate),this.attackInfo)}}get bounceNum(){return Math.floor(this.data.getLevelParam(this.level,0)*this.level+Te.DEFAULT_BOUNCE_NUM)}get nextEffectRate(){return Math.min(this.data.getLevelParam(this.level,1)*this.level+Te.DEFAULT_NEXT_EFFECT_RATE,Te.MAX_NEXT_EFFECT_RATE)}get attackInfo(){var e;let t=null;return((e=this.tower)==null?void 0:e.newBullet().bulletData.hitEffectId)==$.KIND_LIGHTNING?t=u.getLanguageStr(3516):t=u.getLanguageStr(3515),t}};a(Te,"DEFAULT_BOUNCE_NUM",.5),a(Te,"DEFAULT_NEXT_EFFECT_RATE",.35),a(Te,"MAX_NEXT_EFFECT_RATE",1),a(Te,"MAX_DISTANCE",3e3);let Ut=Te;class as extends j{constructor(t,e,l){super(t,e,l),this.index=1080,this.m_updateFunction=()=>{this.burnColdValue>0?this.m_skillInfo=u.getLanguageStr(3005,this.burn):this.m_skillInfo=u.getLanguageStr(3006,P.toPercentage(this.cold))}}get burnColdValue(){let t=1;this.tower&&(t=this.tower.buffEffect());let e=Math.pow(this.data.getLevelParam(this.level,0)*this.level*t,2);return this.data.getLevelParam(this.level,0)<0&&(e=-e),Math.floor(e)}get burn(){return Math.floor(Math.sqrt(this.burnColdValue))}get cold(){let t=1;this.tower&&(t=this.tower.buffEffect());let e=Math.pow(this.data.getLevelParam(this.level,0)*this.level*t,2);return Math.pow(e,.25)*.03}}class yl extends j{constructor(t,e,l){super(t,e,l)}get bulletId(){return this.data.getLevelParam(this.level,0)}}class Ml extends j{constructor(t,e,l){super(t,e,l),this.index=1e3,this.m_updateFunction=()=>{this.damageRate>1?this.m_skillInfo=u.getLanguageStr(3007,P.toPercentage(this.damageRate-1)):this.damageRate<1&&(this.m_skillInfo=u.getLanguageStr(3008,P.toPercentage(1-this.damageRate)))}}get damageAdd(){return this.data.getLevelParam(this.level,0)*this.level}get damageRate(){return this.data.getLevelParam(this.level,1)*this.level+1}get damageA(){return this.data.getLevelParam(this.level,2)}get damageB(){return this.data.getLevelParam(this.level,3)}get damageC(){return this.data.getLevelParam(this.level,4)}isChangeBase(){return!(this.damageA==0&&this.damageB==0&&this.damageC==0)}}class kl extends j{constructor(t,e,l){super(t,e,l),this.index=1010,this.m_updateFunction=()=>{this.rangeRate>1?this.m_skillInfo=u.getLanguageStr(3009,P.toPercentage(this.rangeRate-1)):this.m_skillInfo=u.getLanguageStr(3010,P.toPercentage(1-this.rangeRate)),this.rangeMin>0&&(this.m_skillInfo+=u.getLanguageStr(3027))}}get rangeAdd(){return this.data.getLevelParam(this.level,0)*this.level}get rangeRate(){return this.data.getLevelParam(this.level,1)*this.level+1}get range(){return this.data.getLevelParam(this.level,2)}get rangeMin(){return this.data.getLevelParam(this.level,3)}isChangeBase(){return this.range!=0}}class Fl extends j{constructor(t,e,l){super(t,e,l),this.index=1020,this.m_updateFunction=()=>{this.rateRate>1?this.m_skillInfo=u.getLanguageStr(3011,P.toPercentage(this.rateRate-1)):this.m_skillInfo=u.getLanguageStr(3012,P.toPercentage(1-this.rateRate))}}get rateRate(){return this.data.getLevelParam(this.level,0)+this.data.getLevelParam(this.level,1)*this.level+1}get rate(){return this.data.getLevelParam(this.level,2)}isChangeBase(){return this.rate!=0}}const Ve=class Ve extends j{constructor(t,e,l){super(t,e,l),this.index=1090,this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3013,P.toPercentage(this.chances),this.extraBullet+1)}}get chances(){return Math.max(Math.min(this.data.getLevelParam(this.level,0)+Ve.DEFAULT_CHANCES,1),0)}get extraBullet(){return Math.floor(this.data.getLevelParam(this.level,1)*this.level+Ve.DEFAULT_EXTRA_BULLET)}};a(Ve,"DEFAULT_CHANCES",0),a(Ve,"DEFAULT_EXTRA_BULLET",.5),a(Ve,"DEFAULT_RATE",.08);let Vt=Ve;const we=class we extends j{constructor(t,e,l){super(t,e,l),this.index=1100,this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3014,P.toPercentage(this.chances),this.damageEffectRate.toFixed(1))}}get chances(){return Math.max(Math.min(this.data.getLevelParam(this.level,0)*this.level+we.DEFAULT_CHANCES,1),0)}get damageEffectRate(){return this.data.getLevelParam(this.level,1)*this.level+we.DEFAULT_DAMAGE_EFFECT_RATE+1}get buffEffectRate(){return this.data.getLevelParam(this.level,2)*this.level+we.DEFAULT_BUFF_EFFECT_RATE+1}};a(we,"DEFAULT_CHANCES",.1),a(we,"DEFAULT_DAMAGE_EFFECT_RATE",.5),a(we,"DEFAULT_BUFF_EFFECT_RATE",.1);let $t=we;const Je=class Je extends j{constructor(t,e,l){super(t,e,l),this.index=1110,this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3026,Math.round(this.cussPower),this.duration.toFixed(0))}}get cussPower(){return this.data.getLevelParam(this.level,0)*this.level*this.tower.level+Je.DEFAULT_CUSS_POWER}get duration(){return this.data.getLevelParam(this.level,1)+Je.DEFAULT_DURATION}};a(Je,"DEFAULT_CUSS_POWER",0),a(Je,"DEFAULT_DURATION",0);let Bt=Je;const Tt=class Tt extends j{constructor(t,e,l){super(t,e,l),this.index=1120,this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3015,this.extraBullet+1)}}get extraBullet(){return Math.floor(this.data.getLevelParam(this.level,0)*this.level+Tt.DEFAULT_EXTRA_BULLET)}};a(Tt,"DEFAULT_EXTRA_BULLET",.5);let Ht=Tt;class ss extends j{constructor(t,e,l){super(t,e,l),this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3017)}}get floatDamageRate(){return this.data.getLevelParam(this.level,0)*this.level}}class is extends j{constructor(t,e,l){super(t,e,l),this.m_skillInfo=""}get guideRatio(){return this.data.getLevelParam(this.level,0)}get bulletSpeedRate(){return this.data.getLevelParam(this.level,1)+1}get bulletAccSpeed(){return this.data.getLevelParam(this.level,2)}get guideInfo(){let t=null,e=this.guideRatio;return e<.1?t=u.getLanguageStr(3500):e<.2?t=u.getLanguageStr(3501):e<.3?t=u.getLanguageStr(3502):e<.4?t=u.getLanguageStr(3503):t=u.getLanguageStr(3504),t}}const Ze=class Ze extends j{constructor(t,e,l){super(t,e,l),this.index=1140,this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3019,P.toPercentage(this.chances),this.duration.toFixed(1))}}get chances(){return Math.max(Math.min(this.data.getLevelParam(this.level,0)*this.level+Ze.DEFAULT_CHANCES,1),0)}get duration(){return this.data.getLevelParam(this.level,1)+Ze.DEFAULT_DURATION}};a(Ze,"DEFAULT_CHANCES",.05),a(Ze,"DEFAULT_DURATION",0);let Gt=Ze;const Lt=class Lt extends j{constructor(t,e,l){super(t,e,l),this.index=1130,this.m_skillInfo=u.getLanguageStr(3016)}get chances(){return Math.max(Math.min(this.data.getLevelParam(this.level,0)*this.level+Lt.DEFAULT_CHANCES,1),0)}};a(Lt,"DEFAULT_CHANCES",.05);let Wt=Lt;const Qe=class Qe extends j{constructor(e,l,s){super(e,l,s);a(this,"m_poisonRate",-1);this.index=1150,this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3e3,Math.round(this.poisonRate*this.tower.damage()),this.duration.toFixed(0))}}get poisonRate(){return this.m_poisonRate<0?this.data.getLevelParam(this.level,0)*this.level+Qe.DEFAULT_POISON_RATE:this.m_poisonRate}set poisonRate(e){this.m_poisonRate<0&&(this.m_poisonRate=e)}get duration(){return this.data.getLevelParam(this.level,1)+Qe.DEFAULT_DURATION}};a(Qe,"DEFAULT_POISON_RATE",0),a(Qe,"DEFAULT_DURATION",0);let jt=Qe;const et=class et extends j{constructor(t,e,l){super(t,e,l),this.index=1160,this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3020,P.toPercentage(this.reducedDefenseRate),this.duration.toFixed(1))}}get reducedDefenseRate(){return this.data.getLevelParam(this.level,0)*this.level+et.DEFAULT_REDUCED_DEFENSE_RATE}get duration(){return this.data.getLevelParam(this.level,1)+et.DEFAULT_DURATION}};a(et,"DEFAULT_REDUCED_DEFENSE_RATE",.1),a(et,"DEFAULT_DURATION",0);let Xt=et;const Dt=class Dt extends j{constructor(t,e,l){super(t,e,l),this.index=1170,this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3021,this.extraBullet+1)}}get extraBullet(){return Math.floor(this.data.getLevelParam(this.level,0)*this.level+Dt.DEFAULT_EXTRA_BULLET)}};a(Dt,"DEFAULT_EXTRA_BULLET",.5);let Yt=Dt;const tt=class tt extends j{constructor(t,e,l){super(t,e,l),this.index=1180,this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3022,P.toPercentage(this.chances),this.duration.toFixed(1))}}get chances(){return Math.max(Math.min(this.data.getLevelParam(this.level,0)*this.level+tt.DEFAULT_CHANCES,1),0)}get duration(){return this.data.getLevelParam(this.level,1)+tt.DEFAULT_DURATION}};a(tt,"DEFAULT_CHANCES",.05),a(tt,"DEFAULT_DURATION",0);let zt=tt;const lt=class lt extends j{constructor(t,e,l){super(t,e,l),this.index=1190,this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3023,P.toPercentage(this.slowRate),this.duration.toFixed(1))}}get slowRate(){return this.data.getLevelParam(this.level,0)*this.level+lt.DEFAULT_SLOW_RATE}get duration(){return this.data.getLevelParam(this.level,1)+lt.DEFAULT_DURATION}};a(lt,"DEFAULT_SLOW_RATE",.1),a(lt,"DEFAULT_DURATION",0);let qt=lt;const Ce=class Ce extends j{constructor(t,e,l){super(t,e,l),this.index=1200,this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3024,this.throughoutNum)}}get throughoutNum(){return Math.floor(this.data.getLevelParam(this.level,0)*this.level+Ce.DEFAULT_THROUGHOUT_NUM)}get nextEffectRate(){return Math.min(this.data.getLevelParam(this.level,1)+Ce.DEFAULT_NEXT_EFFECT_RATE,Ce.MAX_NEXT_EFFECT_RATE)}};a(Ce,"DEFAULT_THROUGHOUT_NUM",.5),a(Ce,"DEFAULT_NEXT_EFFECT_RATE",0),a(Ce,"MAX_NEXT_EFFECT_RATE",1);let Jt=Ce;const at=class at extends j{constructor(t,e,l){super(t,e,l),this.index=1210,this.m_updateFunction=()=>{this.m_skillInfo=u.getLanguageStr(3025,P.toPercentage(this.chances),this.duration.toFixed(1))}}get chances(){return Math.max(Math.min(this.data.getLevelParam(this.level,0)*this.level+at.DEFAULT_CHANCES,1),0)}get duration(){return this.data.getLevelParam(this.level,1)+at.DEFAULT_DURATION}};a(at,"DEFAULT_CHANCES",0),a(at,"DEFAULT_DURATION",0);let Zt=at;const ne=class ne extends Pl{constructor(e,l,s,i=!1){super(e,l,i);a(this,"monster");a(this,"m_levelMax",0);this.monster=s,this.m_data.typeId=He.TYPE_MONSTER_SKILL}static getKindName(e){switch(e){case p.KIND_FLY:return u.getLanguageStr(2507);case p.KIND_AIRBORNE:return u.getLanguageStr(2510);case p.KIND_RESIST_FIRE:return u.getLanguageStr(2515,u.getLanguageStr(2710));case p.KIND_RESIST_FROST:return u.getLanguageStr(2515,u.getLanguageStr(2711));case p.KIND_RESIST_POISON:return u.getLanguageStr(2515,u.getLanguageStr(2712));case p.KIND_RESIST_SLOW:return u.getLanguageStr(2515,u.getLanguageStr(2719));case p.KIND_RESIST_BEAT:return u.getLanguageStr(2515,u.getLanguageStr(2717));case p.KIND_RESIST_SILENCE:return u.getLanguageStr(2515,u.getLanguageStr(2722));case p.KIND_RESIST_VERTIGO:return u.getLanguageStr(2515,u.getLanguageStr(2715));case p.KIND_RESIST_CRIT:return u.getLanguageStr(2515,u.getLanguageStr(2716));case p.KIND_RESIST_LIGHT:return u.getLanguageStr(2515,u.getLanguageStr(2714));case p.KIND_RESIST_INTIMIDATE:return u.getLanguageStr(2515,u.getLanguageStr(2718));case p.KIND_RESIST_STRSMOOTH:return u.getLanguageStr(2723);case p.KIND_SLOWF:return u.getLanguageStr(2725);case p.KIND_WEAK_FIRE:return u.getLanguageStr(2516,u.getLanguageStr(2710));case p.KIND_WEAK_FROST:return u.getLanguageStr(2516,u.getLanguageStr(2711));case p.KIND_WEAK_POISON:return u.getLanguageStr(2516,u.getLanguageStr(2712));case p.KIND_WEAK_SLOW:return u.getLanguageStr(2516,u.getLanguageStr(2719));case p.KIND_WEAK_BEAT:return u.getLanguageStr(2516,u.getLanguageStr(2717));case p.KIND_WEAK_SILENCE:return u.getLanguageStr(2516,u.getLanguageStr(2722));case p.KIND_WEAK_VERTIGO:return u.getLanguageStr(2516,u.getLanguageStr(2715));case p.KIND_WEAK_CRIT:return u.getLanguageStr(2516,u.getLanguageStr(2716));case p.KIND_WEAK_LIGHT:return u.getLanguageStr(2516,u.getLanguageStr(2714));case p.KIND_WEAK_INTIMIDATE:return u.getLanguageStr(2516,u.getLanguageStr(2718));case p.KIND_ISOLATION:return u.getLanguageStr(2517);case p.KIND_RUN:return u.getLanguageStr(2500);case p.KIND_MIRROR:return u.getLanguageStr(2501);case p.KIND_SUMMON:return u.getLanguageStr(2502);case p.KIND_CLOUD:return u.getLanguageStr(2503);case p.KIND_CURE:return u.getLanguageStr(2504);case p.KIND_BLINK:return u.getLanguageStr(2505);case p.KIND_HIDE:return u.getLanguageStr(2506);case p.KIND_RELIVE:return u.getLanguageStr(2508);case p.KIND_SUICIDE:return u.getLanguageStr(2509);case p.KIND_SHIELD:return u.getLanguageStr(2511);case p.KIND_SNEER:return u.getLanguageStr(2512);case p.KIND_REINCARNATE:return u.getLanguageStr(2514);case p.KIND_TRANSFORM:return u.getLanguageStr(2513);case p.KIND_LINKS:return u.getLanguageStr(2727);default:return""}}get name(){return this.canLevelUp(1)?u.getLanguageStr(2416,this.data.name,this.level):this.data.name}get isDebuff(){return this.grade.indexOf(ne.RES_FG_X)!=-1}get skillSign(){return this.isDebuff?Kt(u.getLanguageStr(2422),0,!0,13):Kt(u.getLanguageStr(2421),16711680,!0,13)}get isDowerSkill(){return!1}get isLearnSkill(){return!1}getConflictStr(){let e=null,l=0,s=0,i=b.$_conflict_skill_kind,o="";for(l=0;l<i.length;l++)if(e=i[l],e.indexOf(this.data.kindId)!=-1)for(s=0;s<e.length;s++)e[s]!=this.data.kindId&&(o+=ne.getKindName(e[s]),o+=u.getLanguageStr(2406));return o.length>0&&(o=o.slice(0,o.length-1)),o}canLevelUp(e=-1){return e<0&&(e=this.level),e<this.levelMax}get levelMax(){if(this.m_levelMax<=0){const e=b.$_skill_lvup_spend,l=this.grade;if(e[l])for(const s in e[l])this.m_levelMax=Math.max(this.m_levelMax,parseInt(s))+1;else this.m_levelMax=1}return this.m_levelMax}levelUpSpend(e=-1){e<0&&(e=this.level);let l=b.$_skill_lvup_spend,s=this.grade;return l[s]&&l[s][String(e)]?l[s][String(e)]:null}get skillScore(){let e=b.$_skill_grade_score,l=this.grade;return e[l]&&e[l][String(this.level)]?e[l][String(this.level)]:1}get grade(){let e=this.data.id,l=e.indexOf("_");return l==-1?ne.RES_FG_X:e.slice(l+1,e.length)}isEventSkill(){switch(this.data.kindId){case p.KIND_RUN:return!0;default:return!1}}getSubClasses(){switch(this.data.kindId){case p.KIND_FLY:return new us(this.data.id,this.level,this.monster);case p.KIND_AIRBORNE:return new Qt(this.data.id,this.level,this.monster);case p.KIND_RESIST_FIRE:case p.KIND_RESIST_FROST:case p.KIND_RESIST_POISON:case p.KIND_RESIST_SLOW:case p.KIND_RESIST_BEAT:case p.KIND_RESIST_SILENCE:case p.KIND_RESIST_VERTIGO:case p.KIND_RESIST_CRIT:case p.KIND_RESIST_LIGHT:case p.KIND_RESIST_INTIMIDATE:case p.KIND_RESIST_STRSMOOTH:case p.KIND_SLOWF:case p.KIND_WEAK_FIRE:case p.KIND_WEAK_FROST:case p.KIND_WEAK_POISON:case p.KIND_WEAK_SLOW:case p.KIND_WEAK_BEAT:case p.KIND_WEAK_SILENCE:case p.KIND_WEAK_VERTIGO:case p.KIND_WEAK_CRIT:case p.KIND_WEAK_LIGHT:case p.KIND_WEAK_INTIMIDATE:return new Se(this.data.id,this.level,this.monster);case p.KIND_ISOLATION:return new cs(this.data.id,this.level,this.monster);case p.KIND_RUN:return new _s(this.data.id,this.level,this.monster);case p.KIND_MIRROR:return new Ul(this.data.id,this.level,this.monster);case p.KIND_SUMMON:return new Bl(this.data.id,this.level,this.monster);case p.KIND_CLOUD:return new rs(this.data.id,this.level,this.monster);case p.KIND_CURE:return new os(this.data.id,this.level,this.monster);case p.KIND_BLINK:return new ns(this.data.id,this.level,this.monster);case p.KIND_HIDE:return new el(this.data.id,this.level,this.monster);case p.KIND_RELIVE:return new $l(this.data.id,this.level,this.monster);case p.KIND_SUICIDE:return new tl(this.data.id,this.level,this.monster);case p.KIND_SHIELD:return new hs(this.data.id,this.level,this.monster);case p.KIND_SNEER:return new ms(this.data.id,this.level,this.monster);case p.KIND_REINCARNATE:return new Vl(this.data.id,this.level,this.monster);case p.KIND_TRANSFORM:return new gs(this.data.id,this.level,this.monster);case p.KIND_LINKS:return new ds(this.data.id,this.level,this.monster);default:return this}}};a(ne,"RES_SKILL","skill_"),a(ne,"RES_FG_A","A"),a(ne,"RES_FG_B","B"),a(ne,"RES_FG_C","C"),a(ne,"RES_FG_Z","Z"),a(ne,"RES_FG_X","X"),a(ne,"RES_FG_0","0"),a(ne,"RES_BG","bg"),a(ne,"PHOTO_WIDTH",34),a(ne,"PHOTO_HEIGHT",34),a(ne,"PHOTO_ROUND",8);let ce=ne;class Ee extends ce{constructor(t,e,l){super(t,e,l)}warmup(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,0)}cooldown(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,1)}chances(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,2)}eventType(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,3)}duration(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,4)}refreshTag(t=!1){this.skillTag1=this.getTagEventType(),this.nextLevelSkillTag1=this.getTagEventType(this.level+1),this.skillTag2=this.getTagCooldown(),this.nextLevelSkillTag2=this.getTagCooldown(this.level+1),t&&(this.skillTag3=this.getTagDuration(),this.nextLevelSkillTag3=this.getTagDuration(this.level+1))}getTagEventType(t=-1){let e=0;t<0&&(t=this.level);let l="",s=this.eventType(t);if(s.length!=4){for(e=0;e<s.length;e++)s[e]==p.EVENT_RED?l+=u.getLanguageStr(2402)+u.getLanguageStr(2406):s[e]==p.EVENT_YELLOW?l+=u.getLanguageStr(2403)+u.getLanguageStr(2406):s[e]==p.EVENT_GREEN?l+=u.getLanguageStr(2404)+u.getLanguageStr(2406):s[e]==p.EVENT_FULL&&(l+=u.getLanguageStr(2405)+u.getLanguageStr(2406));l=l.slice(0,l.length-1),l=u.getLanguageStr(2400,l)}return l}getTagCooldown(t=-1){return t<0&&(t=this.level),""+u.getLanguageStr(2401,this.cooldown(t))}getTagDuration(t=-1){return t<0&&(t=this.level),""+u.getLanguageStr(2407,this.duration(t))}}class Qt extends ce{constructor(t,e,l){super(t,e,l),this.index=95,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2201)}}heightSpeed(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,0)}pathLengthMin(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,1)}pathLengthMax(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,2)}}a(Qt,"BALLOON","balloon"),a(Qt,"DEFAULT_HEIGHT",2e3);class ns extends Ee{constructor(t,e,l){super(t,e,l),this.index=100,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2303,P.toGridStr(this.range())),this.m_nextLevelSkillInfo=u.getLanguageStr(2303,P.toGridStr(this.range(this.level+1))),this.refreshTag()}}range(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,5)}}class rs extends Ee{constructor(t,e,l){super(t,e,l),this.index=110,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2302,this.cloudTime()),this.m_nextLevelSkillInfo=u.getLanguageStr(2302,this.cloudTime(this.level+1)),this.refreshTag(!0)}}range(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,5)}cloudTime(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,6)}}class os extends Ee{constructor(t,e,l){super(t,e,l),this.index=140,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2300,P.toGridStr(this.cureRange()),P.toPercentage(this.cureRate())),this.m_nextLevelSkillInfo=u.getLanguageStr(2300,P.toGridStr(this.cureRange(this.level+1)),P.toPercentage(this.cureRate(this.level+1))),this.refreshTag()}}cureRange(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,5)}cureRate(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,6)}}class us extends ce{constructor(t,e,l){super(t,e,l),this.index=90,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2200),this.m_nextLevelSkillInfo=u.getLanguageStr(2200)}}get flyHeight(){return this.data.getLevelParam(this.level,0)}}class el extends Ee{constructor(t,e,l){super(t,e,l),this.index=150,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2305,this.duration()),this.m_nextLevelSkillInfo=u.getLanguageStr(2305,this.duration(this.level+1)),this.refreshTag()}}}a(el,"HIDE_TIME",1),a(el,"HIDE_ALPHA",.1);class cs extends ce{constructor(t,e,l){super(t,e,l),this.index=500,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2202)}}}class ds extends Ee{constructor(t,e,l){super(t,e,l),this.index=116,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2728,P.toGridStr(this.range()),P.toPercentage(this.shieldRate()),this.duration()),this.m_nextLevelSkillInfo=u.getLanguageStr(2728,P.toGridStr(this.range(this.level+1)),P.toPercentage(this.shieldRate(this.level+1)),this.duration(this.level+1)),this.refreshTag()}}range(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,5)}shieldRate(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,6)}}class Ul extends Ee{constructor(t,e,l){super(t,e,l),this.index=130,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2306,this.mirrorNum(),P.toPercentage(this.hpRate()),this.duration()),this.m_nextLevelSkillInfo=u.getLanguageStr(2306,this.mirrorNum(this.level+1),P.toPercentage(this.hpRate(this.level+1)),this.duration(this.level+1)),this.refreshTag()}}mirrorNum(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,5)}hpRate(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,6)}}a(Ul,"DEFAULT_DISTANCE",750);class Vl extends ce{constructor(t,e,l){super(t,e,l),this.index=85,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2215,this.monsterName()),this.m_nextLevelSkillInfo=u.getLanguageStr(2215,this.monsterName(this.level+1))}}monsterIdList(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,0)}monsterName(t=-1){let e=0,l=this.monsterIdList(t),s="";for(e=0;e<l.length;e++)s+=fe.getOnlyExample().getData(l[e]).name,s+=u.getLanguageStr(2406);return s.slice(0,s.length-1),s}}a(Vl,"REINCARNATE_TIME",5);class $l extends ce{constructor(t,e,l){super(t,e,l),this.index=170,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2213,this.reliveNum(),P.toPercentage(this.reliveHpRate())),this.m_nextLevelSkillInfo=u.getLanguageStr(2213,this.reliveNum(this.level+1),P.toPercentage(this.reliveHpRate(this.level+1)))}}reliveNum(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,0)}reliveHpRate(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,1)}}a($l,"RELIVE_TIME",8);class Se extends ce{constructor(e,l,s){super(e,l,s);a(this,"maxHP",0);this.index=300,this.m_updateFunction=function(){this.m_skillInfo=this.resistInfo(),this.m_nextLevelSkillInfo=this.resistInfo(this.level+1)}}getResist(e=-1){return e<0&&(e=this.level),this.data.getLevelParam(e,0)}getRange(e=-1){return e<0&&(e=this.level),this.data.getLevelParam(e,1)}getMaxHP(e=-1){return e<0&&(e=this.level),this.data.getLevelParam(e,1)}resistInfo(e=-1){let l=this.getResist(e),s="",i=P.toPercentage(Math.abs(l));return l==0||(l>0?s=u.getLanguageStr(2409):s=u.getLanguageStr(2408),this.data.kindId==p.KIND_SLOWF&&(s=P.toGridStr(this.getRange())),s=u.getLanguageStr(this.resistInfoNumber,s,i),this.data.kindId==p.KIND_RESIST_STRSMOOTH&&this.getMaxHP(e)>0&&(s+=u.getLanguageStr(2730,this.getMaxHP(e)))),s}get resistInfoNumber(){switch(this.data.kindId){case p.KIND_RESIST_FIRE:case p.KIND_WEAK_FIRE:return 2203;case p.KIND_RESIST_FROST:case p.KIND_WEAK_FROST:return 2204;case p.KIND_RESIST_POISON:case p.KIND_WEAK_POISON:return 2205;case p.KIND_RESIST_SLOW:case p.KIND_WEAK_SLOW:return 2206;case p.KIND_RESIST_BEAT:case p.KIND_WEAK_BEAT:return 2207;case p.KIND_RESIST_SILENCE:case p.KIND_WEAK_SILENCE:return 2208;case p.KIND_RESIST_VERTIGO:case p.KIND_WEAK_VERTIGO:return 2209;case p.KIND_RESIST_CRIT:case p.KIND_WEAK_CRIT:return 2210;case p.KIND_RESIST_LIGHT:case p.KIND_WEAK_LIGHT:return 2211;case p.KIND_RESIST_INTIMIDATE:case p.KIND_WEAK_INTIMIDATE:return 2212;case p.KIND_RESIST_STRSMOOTH:return 2724;case p.KIND_SLOWF:return 2726;default:return 0}}}a(Se,"IMMUNITY",2701),a(Se,"RESIST_SUPER",2702),a(Se,"RESIST_HIGH",2703),a(Se,"RESIST",2704),a(Se,"FEAR",2705),a(Se,"FEAR_HIGH",2706),a(Se,"FEAR_SUPER",2707);class _s extends Ee{constructor(t,e,l){super(t,e,l),this.index=160,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2304,P.toPercentage(this.speedRate()-1),this.duration()),this.m_nextLevelSkillInfo=u.getLanguageStr(2304,P.toPercentage(this.speedRate(this.level+1)-1),this.duration(this.level+1)),this.refreshTag()}}speedRate(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,5)+1}}class hs extends Ee{constructor(t,e,l){super(t,e,l),this.index=105,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2308,P.toPercentage(this.shieldRate()),this.shieldTime()),this.m_nextLevelSkillInfo=u.getLanguageStr(2308,P.toPercentage(this.shieldRate(this.level+1)),this.shieldTime(this.level+1)),this.refreshTag(!0)}}range(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,5)}shieldTime(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,6)}shieldRate(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,7)}}class ms extends Ee{constructor(t,e,l){super(t,e,l),this.index=106,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2309,P.toGridStr(this.range()),P.toPercentage(this.shieldRate()),this.duration()),this.m_nextLevelSkillInfo=u.getLanguageStr(2309,P.toGridStr(this.range(this.level+1)),P.toPercentage(this.shieldRate(this.level+1)),this.duration(this.level+1)),this.refreshTag()}}range(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,5)}shieldRate(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,6)}}class tl extends ce{constructor(t,e,l){super(t,e,l),this.index=185,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2214,P.toGridStr(this.cloudRange()),this.cloudTime()),this.m_nextLevelSkillInfo=u.getLanguageStr(2214,P.toGridStr(this.cloudRange(this.level+1)),this.cloudTime(this.level+1))}}cloudRange(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,0)}cloudTime(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,1)}}a(tl,"isEveryTime",!0),a(tl,"SUICIDE_TIME",.5);class Bl extends Ee{constructor(t,e,l){super(t,e,l),this.index=120,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2301,this.summonNum(),P.toPercentage(this.hpRate()),this.summonName()),this.m_nextLevelSkillInfo=u.getLanguageStr(2301,this.summonNum(this.level+1),P.toPercentage(this.hpRate(this.level+1)),this.summonName(this.level+1)),this.refreshTag(!0)}}summonId(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,5)}summonName(t=-1){return t<0&&(t=this.level),fe.getOnlyExample().getData(this.summonId(t)).name}summonNum(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,6)}hpRate(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,7)}}a(Bl,"DEFAULT_DISTANCE",750);class gs extends Ee{constructor(t,e,l){super(t,e,l),this.index=95,this.m_updateFunction=function(){this.m_skillInfo=u.getLanguageStr(2307,this.transformName()),this.m_nextLevelSkillInfo=u.getLanguageStr(2307,this.transformName(this.level+1)),this.refreshTag(!0)}}transformId(t=-1){return t<0&&(t=this.level),this.data.getLevelParam(t,5)}transformName(t=-1){return t<0&&(t=this.level),fe.getOnlyExample().getData(this.transformId(t)).name}}class Hl extends dt{constructor(e,l=1){super();a(this,"level");this.m_data=yt.getOnlyExample().getData(e),this.level=l}get skillsPackageData(){return this.m_data}}class Gl{}a(Gl,"COLOR_LIST",[6316128,13631488,13668352,43520,28927,8913056,0]);const se=class se extends ve{constructor(e){super(e);a(this,"m_price");a(this,"priceCoin",0);a(this,"priceGold",0);a(this,"priceScore",0);a(this,"unlockMapId","");a(this,"index",0);this.m_price=e[se.DATA_PRICE],this.initPrice(),this.unlockMapId=e[se.DATA_UNLOCK_MAP_ID],this.index=e[se.DATA_INDEX]}get price(){return this instanceof ot&&ee.currentMap&&ee.currentMap.isDefendMap&&this.campPrice instanceof Array?this.campPrice:this.m_price}initPrice(){let e=this.price;if(e)if(e instanceof Array){const l=e;l[0]==se.DATA_COIN?this.priceCoin=l[1]:l[0]==se.DATA_GOLD?this.priceGold=l[1]:l[0]==se.DATA_SCORE&&(this.priceScore=l[1])}else this.priceCoin=e[se.DATA_COIN],this.priceGold=e[se.DATA_GOLD],this.priceScore=e[se.DATA_SCORE]}get isRare(){if(this.priceCoin>0){if(this.priceCoin>=b.$_rare_item_coin||this.index<0)return!0}else if(this.priceScore>0&&(this.priceScore>=b.$_rare_item_invite_score||this.index<0))return!0;return!1}};a(se,"DATA_PRICE","price"),a(se,"DATA_UNLOCK_MAP_ID","unlock_mid"),a(se,"DATA_COIN","coin"),a(se,"DATA_GOLD","gold"),a(se,"DATA_SCORE","invite_score"),a(se,"DATA_INDEX","index");let ft=se;const re=class re extends ft{constructor(e){super(e);a(this,"gemLevel");a(this,"towerSkillPackage");a(this,"nextLevelId");a(this,"colorIndex");this.typeId=ve.TYPE_GEM_ITEM,this.gemLevel=e[re.DATA_GEM_LEVEL],this.towerSkillPackage=e[re.DATA_TOWER_SKILL_PACKAGE],this.nextLevelId=e[re.DATA_NEXT_LEVEL_ID],this.colorIndex=e[re.DATA_COLOR_INDEX],this.res=this.resString}getSkillPackage(e){if(this.towerSkillPackage==null)return null;let l=/\D/gi;e=e.match(l).join("");let s=this.towerSkillPackage[e];return s==null?null:new Hl(s[re.SKILL_PACKAGE_ID],s[re.SKILL_PACKAGE_LEVEL])}get color(){return Gl.COLOR_LIST[this.colorIndex]}get resString(){return"hong"+this.gemLevel}};a(re,"TYPE_PURE","typePure"),a(re,"TYPE_MIX","typeMix"),a(re,"DATA_GEM_LEVEL","gamLevel"),a(re,"DATA_TOWER_SKILL_PACKAGE","sp"),a(re,"DATA_NEXT_LEVEL_ID","nextId"),a(re,"DATA_COLOR_INDEX","color"),a(re,"SKILL_PACKAGE_ID","id"),a(re,"SKILL_PACKAGE_LEVEL","lv");let ll=re;const Re=class Re extends ze{constructor(){super(),Re.onlyExample=this,this.loadData(b.$_global_properties[ve.TYPE_GEM_ITEM])}static getOnlyExample(){return Re.onlyExample==null&&(Re.onlyExample=new Re),Re.onlyExample}loadData(t){let e;for(e in t)this.m_manager[e]=new ll(t[e])}initData(){}getData(t){return this.getDataById(t)}};a(Re,"onlyExample");let al=Re;const Q=class Q extends ft{constructor(e){super(e);a(this,"skillPackageId");a(this,"skillPackageLevel");a(this,"skills");a(this,"xGrid");a(this,"yGrid");if(this.skillPackageId=e[Q.DATA_SKILL_PACKAGE_ID],this.skillPackageLevel=e[Q.DATA_SKILL_PACKAGE_LEVEL],e[Q.DATA_SKILLS]instanceof Array)this.skills=e[Q.DATA_SKILLS];else if(e[Q.DATA_SKILLS]instanceof Object){this.skills=[];for(const l in e[Q.DATA_SKILLS])this.skills.push({skid:l,lev:e[Q.DATA_SKILLS][l]})}e[Q.DATA_X_GRID]?this.xGrid=e[Q.DATA_X_GRID]:this.xGrid=1,e[Q.DATA_Y_GRID]?this.yGrid=e[Q.DATA_Y_GRID]:this.yGrid=1}};a(Q,"DATA_A","a"),a(Q,"DATA_B","b"),a(Q,"DATA_C","c"),a(Q,"DATA_D","d"),a(Q,"DATA_SKILL_PACKAGE_ID","skill"),a(Q,"DATA_SKILL_PACKAGE_LEVEL","skillLv"),a(Q,"DATA_SKILLS","skills"),a(Q,"DATA_X_GRID","x_grid"),a(Q,"DATA_Y_GRID","y_grid");let te=Q;const z=class z extends te{constructor(e){super(e);a(this,"m_buildValueA",0);a(this,"m_buildValueB",0);a(this,"m_buildValueC",0);a(this,"m_campPrice",["",0]);a(this,"m_campBuildValueA",0);a(this,"m_campBuildValueB",0);a(this,"m_campBuildValueC",0);a(this,"range");a(this,"rate");a(this,"limitNum");e[z.DATA_BUILD_VALUE]?(this.m_buildValueA=e[z.DATA_BUILD_VALUE][te.DATA_A],this.m_buildValueB=e[z.DATA_BUILD_VALUE][te.DATA_B],this.m_buildValueC=e[z.DATA_BUILD_VALUE][te.DATA_C]):e[z.DATA_EXP_VALUE]&&(this.m_buildValueA=e[z.DATA_EXP_VALUE][te.DATA_A],this.m_buildValueB=e[z.DATA_EXP_VALUE][te.DATA_B],this.m_buildValueC=e[z.DATA_EXP_VALUE][te.DATA_C]),e[z.DATA_CAMP_PRICE]&&(this.m_campPrice=e[z.DATA_CAMP_PRICE]),e[z.DATA_CAMP_BUILD_VALUE]&&(this.m_campBuildValueA=e[z.DATA_CAMP_BUILD_VALUE][te.DATA_A],this.m_campBuildValueB=e[z.DATA_CAMP_BUILD_VALUE][te.DATA_B],this.m_campBuildValueC=e[z.DATA_CAMP_BUILD_VALUE][te.DATA_C]),this.range=e[z.DATA_RANGE],this.rate=Math.round(e[z.DATA_RATE]*10),this.limitNum=e[z.DATA_LIMIT_NUM]}get buildValueA(){return ee.currentMap&&ee.currentMap.isDefendMap?this.m_campBuildValueA:this.m_buildValueA}get buildValueB(){return ee.currentMap&&ee.currentMap.isDefendMap?this.m_campBuildValueB:this.m_buildValueB}get buildValueC(){return ee.currentMap&&ee.currentMap.isDefendMap?this.m_campBuildValueC:this.m_buildValueC}get campPrice(){return this.m_campPrice}get buildCostPrice(){return this.price[0]}get buildCost(){return this.price[1]}get buildValueAConst(){return this.m_buildValueA}get buildValueBConst(){return this.m_buildValueB}get buildValueCConst(){return this.m_buildValueC}get buildCostPriceConst(){return this.m_price[0]}get buildCostConst(){return this.m_price[1]}};a(z,"DATA_BUILD_VALUE","build_val"),a(z,"DATA_EXP_VALUE","exp_val"),a(z,"DATA_CAMP_PRICE","camp_price"),a(z,"DATA_CAMP_BUILD_VALUE","camp_build_val"),a(z,"DATA_RANGE","range"),a(z,"DATA_RATE","rate"),a(z,"DATA_LIMIT_NUM","limit_num");let ot=z;const F=class F extends ot{constructor(e){super(e);a(this,"valueList");a(this,"effectType");a(this,"effectKind");a(this,"effectRange");a(this,"useNum");a(this,"colddown");a(this,"delay");a(this,"attackEffectId");this.typeId=ve.TYPE_TRAP_ITEM,this.valueList=e[F.DATA_VALUE_LIST],this.effectType=e[F.DATA_EFFECT_TYPE],this.effectKind=e[F.DATA_EFFECT_KIND],e[F.DATA_USE_NUM]?this.useNum=e[F.DATA_USE_NUM]:this.useNum=1,e[F.DATA_COLDDOWN]?this.colddown=e[F.DATA_COLDDOWN]:this.colddown=.1,e[F.DATA_DELAY]?this.delay=e[F.DATA_DELAY]:this.delay=0,e[F.DATA_EFFECT_RANGE]?this.effectRange=e[F.DATA_EFFECT_RANGE]:this.effectRange=this.range,this.attackEffectId=e[F.DATA_EFFECT]}};a(F,"KIND_BLAST","1"),a(F,"KIND_DAMAGE","2"),a(F,"KIND_VERTIGO","3"),a(F,"KIND_SLOW","4"),a(F,"KIND_BEAT_BACK","5"),a(F,"KIND_COLD_BULLET","50"),a(F,"KIND_BULLET","100"),a(F,"KIND_BULLET_RANDOM","101"),a(F,"EFFECT_TYPE_FLOOR","1"),a(F,"EFFECT_TYPE_AIR","2"),a(F,"EFFECT_TYPE_ALL","3"),a(F,"EFFECT_TYPE_LIGHTNING","4"),a(F,"EFFECT_KIND_SINGLE","1"),a(F,"EFFECT_KIND_MULTI","2"),a(F,"DATA_VALUE_LIST","value"),a(F,"DATA_EFFECT_TYPE","effectType"),a(F,"DATA_EFFECT_KIND","effectKind"),a(F,"DATA_EFFECT_RANGE","effectRange"),a(F,"DATA_USE_NUM","use_times"),a(F,"DATA_COLDDOWN","colddown"),a(F,"DATA_DELAY","delay"),a(F,"DATA_EFFECT","effect");let sl=F;class El extends ot{constructor(e){super(e);a(this,"m_buildCostA");a(this,"m_buildCostB");a(this,"m_buildCostC");a(this,"m_campBuildCostA");a(this,"m_campBuildCostB");a(this,"m_campBuildCostC");a(this,"damageA");a(this,"damageB");a(this,"damageC");a(this,"bulletId","");a(this,"buffEffect");a(this,"levelMax");this.m_buildCostA=e.build_cost.a,this.m_buildCostB=e.build_cost.b,this.m_buildCostC=e.build_cost.c,this.m_campBuildCostA=e.camp_build_cost.a,this.m_campBuildCostB=e.camp_build_cost.b,this.m_campBuildCostC=e.camp_build_cost.c,this.damageA=e.damage.a,this.damageB=e.damage.b,this.damageC=e.damage.c,this.buffEffect=e.buffEffect,this.levelMax=e.lev_max,this.bulletId=e.bId}get buildCostA(){var e;return(e=ee.currentMap)!=null&&e.isDefendMap?this.m_campBuildCostA:this.m_buildCostA}get buildCostB(){var e;return(e=ee.currentMap)!=null&&e.isDefendMap?this.m_campBuildCostB:this.m_buildCostB}get buildCostC(){var e;return(e=ee.currentMap)!=null&&e.isDefendMap?this.m_campBuildCostC:this.m_buildCostC}get buildCostAConst(){return this.m_buildCostA}get buildCostBConst(){return this.m_buildCostB}get buildCostCConst(){return this.m_buildCostC}get buildCostPriceConst(){return this.m_price[0]}get buildCostConst(){return this.m_price[1]}get isMagicTower(){return this.id=="xiangqianta"}}const Ke=class Ke extends ze{constructor(){super(),Ke.onlyExample=this,this.loadData(b.$_towerAtt_Obj)}static getOnlyExample(){return Ke.onlyExample==null&&(Ke.onlyExample=new Ke),Ke.onlyExample}loadData(t){for(const e in t){const l=t[e];l[de.DATA_ID]=e,this.m_manager[e]=new El(t[e])}}getData(t){return this.getDataById(t)}};a(Ke,"onlyExample");let il=Ke;const Y=class Y extends te{constructor(e){super(e);a(this,"shapeMode");a(this,"damageMode");a(this,"radii");a(this,"shadow");a(this,"fallAccSpeed");a(this,"floorPathId");a(this,"hitEffectId");this.shapeMode=e[Y.DATA_SHAPE_MODE],this.damageMode=e[Y.DATA_DAMAGE_MODE],this.radii=e[Y.DATA_RADII],e[Y.DATA_SHADOW]?this.shadow=e[Y.DATA_SHADOW]:this.shadow=1,this.fallAccSpeed=e[Y.DATA_FALL_ACC_SPEED],this.floorPathId=e[Y.DATA_FLOOR_PATH_ID],this.hitEffectId=e[Y.DATA_HIT_EFFECT_ID]}};a(Y,"SHAPE_COMMON",0),a(Y,"SHAPE_DIRECTION",1),a(Y,"SHAPE_ROLL",2),a(Y,"DAMAGE_NULL",0),a(Y,"DAMAGE_COMMON",1),a(Y,"DAMAGE_PERFORATIVE",2),a(Y,"DAMAGE_MAGICAL",3),a(Y,"DAMAGE_SIEGE",4),a(Y,"DAMAGE_MIXED",5),a(Y,"FALL_ACC_SPEED_THRESHOLD",-7),a(Y,"DATA_SHAPE_MODE","shapeMode"),a(Y,"DATA_DAMAGE_MODE","damageMode"),a(Y,"DATA_RADII","radii"),a(Y,"DATA_SHADOW","shadow"),a(Y,"DATA_FALL_ACC_SPEED","fallAcc"),a(Y,"DATA_FLOOR_PATH_ID","path"),a(Y,"DATA_HIT_EFFECT_ID","effect");let nl=Y;const Oe=class Oe extends ze{constructor(){super(),Oe.onlyExample=this,this.loadData(b.$_bulletAtt_Obj)}static getOnlyExample(){return Oe.onlyExample==null&&(Oe.onlyExample=new Oe),Oe.onlyExample}loadData(t){for(const e in t){const l=t[e];l[de.DATA_ID]=e,this.m_manager[e]=new nl(t[e])}}getData(t){return this.getDataById(t)}};a(Oe,"onlyExample");let rl=Oe;const K=class K extends te{constructor(e){super(e);a(this,"hpMaxA");a(this,"hpMaxB");a(this,"hpMaxC");a(this,"expMaxA",0);a(this,"expMaxB",0);a(this,"expMaxC",0);a(this,"expMaxD",0);a(this,"speedBase");a(this,"charm");a(this,"height");a(this,"width");a(this,"speakList",[]);a(this,"population");e[K.DATA_HP_MAX]?(this.hpMaxA=e[K.DATA_HP_MAX][te.DATA_A],this.hpMaxB=e[K.DATA_HP_MAX][te.DATA_B],this.hpMaxC=e[K.DATA_HP_MAX][te.DATA_C]):(this.hpMaxA=e[K.DATA_HP_MAX_A],this.hpMaxB=e[K.DATA_HP_MAX_B],this.hpMaxC=e[K.DATA_HP_MAX_C]),e[K.DATA_EXP_MAX]&&(this.expMaxA=e[K.DATA_EXP_MAX][te.DATA_A],this.expMaxB=e[K.DATA_EXP_MAX][te.DATA_B],this.expMaxC=e[K.DATA_EXP_MAX][te.DATA_C],this.expMaxD=e[K.DATA_EXP_MAX][te.DATA_D]),this.speedBase=e[K.DATA_SPEED_BASE],this.charm=e[K.DATA_CHARM],this.height=e[K.DATA_HEIGHT],this.width=e[K.DATA_WIDTH],e[K.DATA_SPEAK_LIST]instanceof Array&&(this.speakList=e[K.DATA_SPEAK_LIST]),this.population=e[K.DATA_POPULATION]}getSpeak(e=0){if(this.speakList instanceof Array&&this.speakList.length>e){if(this.speakList[e]instanceof String)return this.speakList[e];if(this.speakList[e]instanceof Array){const l=this.speakList[e];return l[Math.floor(Math.random()*l.length)]}}return""}getSpeakEnter(){return this.getSpeak(K.SPEAK_ENTER)}getSpeakIdle(){return this.getSpeak(K.SPEAK_IDLE)}getSpeakInjury(){return this.getSpeak(K.SPEAK_INJURY)}getSpeakDie(){return this.getSpeak(K.SPEAK_DIE)}getSpeakInvade(){return this.getSpeak(K.SPEAK_INVADE)}getSpeakCast(){return this.getSpeak(K.SPEAK_CAST)}get isBoss(){return this.population>=100}get isRandomBoss(){return this.population==99}getHpMax(e,l=1){return Math.floor((this.hpMaxA+e*(this.hpMaxB+e*this.hpMaxC))*l)}};a(K,"SPEAK_ENTER",0),a(K,"SPEAK_IDLE",1),a(K,"SPEAK_INJURY",2),a(K,"SPEAK_DIE",3),a(K,"SPEAK_INVADE",4),a(K,"SPEAK_CAST",5),a(K,"DEFENSE_NULL",0),a(K,"DEFENSE_LIGHT",1),a(K,"DEFENSE_COMMON",2),a(K,"DEFENSE_HEAVY",3),a(K,"DEFENSE_BUILDING",4),a(K,"DEFENSE_BOSS",5),a(K,"DEFENSE_HOLY",6),a(K,"DEFENSE_INVINCIBLE",7),a(K,"DATA_HP_MAX","hp_factor"),a(K,"DATA_EXP_MAX","explev"),a(K,"DATA_HP_MAX_A","ha"),a(K,"DATA_HP_MAX_B","hb"),a(K,"DATA_HP_MAX_C","hc"),a(K,"DATA_SPEED_BASE","speed"),a(K,"DATA_CHARM","charm"),a(K,"DATA_HEIGHT","height"),a(K,"DATA_WIDTH","width"),a(K,"DATA_SPEAK_LIST","speak"),a(K,"DATA_POPULATION","pop");let At=K;const Pe=class Pe extends ze{constructor(){super(),Pe.onlyExample=this,this.loadData(b.$_wolfAtt_Obj)}static getOnlyExample(){return Pe.onlyExample==null&&(Pe.onlyExample=new Pe),Pe.onlyExample}loadData(t){for(const e in t){const l=t[e];l[de.DATA_ID]=e,this.m_manager[e]=new At(l)}}getBossList(t){const e=[];if(!(t instanceof Array))return e;for(let l=0;l<t.length;l++){const s=this.getData(t[l]);s&&s.isBoss&&e.push(t[l])}return e}getRandomBossList(t){const e=[];if(!(t instanceof Array))return e;for(let l=0;l<t.length;l++){const s=this.getData(t[l]);s&&s.isRandomBoss&&e.push(t[l])}return e}getData(t){return this.getDataById(t)}};a(Pe,"onlyExample");let fe=Pe;function ps(_){return Fa(_)}function it(_,t,e){return Ea.hsl(ps(_),t,e).string()}const Wl=J({__name:"WolfHpChart",props:{hpData:{},width:{default:600},height:{default:200}},setup(_){hl([ml,gl,pl,fl,Al]);const t=_,e=G(()=>({color:["#00A2E8"],title:{text:"当前狼血量",left:"center",textStyle:{fontStyle:"normal",fontFamily:"sans-serif",fontSize:16}},tooltip:{},xAxis:{type:"value",axisLine:{show:!0,lineStyle:{width:1,type:"solid"}}},yAxis:{type:"category",axisTick:{alignWithLabel:!0},axisLabel:{fontSize:14},data:t.hpData.map(l=>l.name)},grid:{left:100,top:30,bottom:20},series:{type:"bar",barWidth:"60%",label:{show:!0,position:"right"},showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)"},data:t.hpData.map(l=>l.value),itemStyle:{color:function(l){return it(l.name,80,45)}}}}));return(l,s)=>(g(),M(d(_l),{class:"chart",option:d(e),style:Sl({width:`${l.width}px`,height:`${l.height}px`})},null,8,["option","style"]))}});function jl(_,t){const e=b.$_wolfAtt_Obj[_].pop;return e<99?e:t??e}function fs(_,t=1){return W.sumBy(_,e=>jl(e,t))}function Ll(_,t){return Math.round((2+1.07*t)*Math.pow(_/.39,2/3))}function As(_,t){const e=b.dream_data.dm_opt_cfg.tower_sum_exp;return Math.round(t*Math.pow(_,e.power)*e.popu+e.p)}function Es(_,t){const e=b.$_map_Obj[_],l=e.wolf_proportion;let s=e.pop_max;const i=l.map(x=>x[0]),o=l.map(x=>jl(x[1]));let r=l.map(x=>x[1]),h=o.length;if(h==0)return[[],[]];let m=[],f=new Array(h).fill(0);if(t&&(m=t.flatMap((x,w)=>new Array(x).fill(r[w])),f=t,t.length=o.length,s-=W.chain(o).zip(t).sumBy(x=>x[0]*x[1]).value(),s<0))return null;for(;s>0;){for(;h>0&&s<o[h-1];)h--;if(h==0)break;let x;do{const w=Math.random()*i[h-1];x=W.findIndex(i,D=>w<D)}while(s<o[x]);s-=o[x],m.push(r[x]),f[x]++}return[t?W.shuffle(m):m,W.zip(r,f)]}const Is={class:"space-x-4"},Ts=J({__name:"dmap-detail",setup(_){const t=W.chain(b.dream_maps).toArray().sortBy("index").value(),e=me({mid:"m2A",score:1}),l=G(()=>b.dream_maps[e.mid]),s=C=>C%10===0?(C-10)%100+10:C%10,i=C=>{const R=s(C).toString(),E=b.dream_waves[e.mid];return C%10==0?E.boss[R]:E.wolf[R]},o=G(()=>i(e.score).map(C=>fe.getOnlyExample().getData(C))),r=(C,R)=>{const E=s(R).toString();return b.dream_waves[e.mid].popu[E]},h=G(()=>r(e.mid,e.score)),m=C=>As(C,r(e.mid,C==0?1:C==9?10:s(C))),f=G(()=>m(e.score)),x=G(()=>Math.sqrt(l.value.hard_ness*e.score+l.value.yield_val)),w=G(()=>{for(const[C,R]of Object.entries(b.dream_data.dm_wolf_hard_ness)){const[E,S]=C.split("_");if(e.score>=Number.parseInt(E)&&e.score<=Number.parseInt(S))return R}return b.dream_data.dm_wolf_hard_ness.default}),D=G(()=>o.value.map(C=>({name:C.name,value:C.getHpMax(x.value,w.value)}))),O=G(()=>{let C=0,R=0;for(let E=1;E<=e.score;E++){let S=Math.sqrt(l.value.yield_val+l.value.hard_ness*E);C+=Ll(S,r(e.mid,E)),R+=m(E)}return{gold:C,exp:R}});return(C,R)=>{const E=ye,S=Me,V=nt,y=je,X=Ae,le=vt("vue-latex"),q=Xe;return g(),M(q,{model:d(e),"label-width":"120px"},{default:c(()=>[n(y,{label:"地图"},{default:c(()=>[n(S,{modelValue:d(e).mid,"onUpdate:modelValue":R[0]||(R[0]=ae=>d(e).mid=ae)},{default:c(()=>[(g(!0),v(k,null,B(d(t),ae=>(g(),M(E,{key:ae.id,label:`${ae.id} ${ae.name}`,value:ae.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),n(V,{effect:"light",class:"mx-1"},{default:c(()=>[N(" 难度系数："+T(d(l).hard_ness)+", "+T(d(l).yield_val),1)]),_:1})]),_:1}),n(y,{label:"进度"},{default:c(()=>[n(X,{modelValue:d(e).score,"onUpdate:modelValue":R[1]||(R[1]=ae=>d(e).score=ae),min:0},null,8,["modelValue"]),n(V,{effect:"light",class:"mx-1"},{default:c(()=>[N(" HpRate："+T(d(w)),1)]),_:1}),n(V,{effect:"light",class:"mx-1"},{default:c(()=>[N(" Population："+T(d(h)),1)]),_:1})]),_:1}),n(y,null,{default:c(()=>[N(" 银币： "),n(le,{expression:`G(x) = (2+1.07p)(\\frac{L(x)}{0.39})^{2/3} = ${d(Ll)(d(x),d(h))}`},null,8,["expression"])]),_:1}),n(y,null,{default:c(()=>[N(" 经验： "),n(le,{expression:`E(x) = (3.5+0.14p)(\\frac{L(x)}{0.39})^{2/3} = ${d(f)}`},null,8,["expression"])]),_:1}),n(y,null,{default:c(()=>[I("div",Is,[I("span",null,"总银币："+T(d(O).gold),1),I("span",null,"总经验："+T(d(O).exp),1)])]),_:1}),n(Wl,{"hp-data":d(D),height:300},null,8,["hp-data"])]),_:1},8,["model"])}}});const Ls=Object.freeze(Object.defineProperty({__proto__:null,default:Ts},Symbol.toStringTag,{value:"Module"})),Ds={key:0,class:"space-y-1"},vs={class:"space-x-0.5"},Ss=J({__name:"dmaps",setup(_){const t=W.sortBy(Object.values(b.dream_maps),"name").map(e=>({...e,...b.dream_waves[e.id],waves:Object.assign({},b.dream_waves[e.id].wolf,b.dream_waves[e.id].boss)}));return(e,l)=>{const s=Ge,i=nt,o=We;return g(),v("div",null,[n(o,{data:d(t)},{default:c(()=>[n(s,{prop:"id",label:"id",sortable:"",align:"center"}),n(s,{prop:"name",label:"name",sortable:"",align:"center"}),n(s,{prop:"interval",label:"interval",sortable:"",align:"center"}),n(s,{prop:"interval_rule",label:"interval_rule",sortable:"",align:"center"}),n(s,{prop:"hard_ness",label:"hard_ness",sortable:"",align:"center"}),n(s,{prop:"yield_val",label:"yield_val",sortable:"",align:"center"}),n(s,{label:"waves",type:"expand",width:"80"},{default:c(r=>[r.row.waves?(g(),v("div",Ds,[I("table",null,[(g(!0),v(k,null,B(r.row.waves,(h,m)=>(g(),v("tr",{key:m},[I("td",null,[n(i,null,{default:c(()=>[N(T(m),1)]),_:2},1024)]),I("td",vs,[(g(!0),v(k,null,B(h,f=>(g(),M(i,{key:f,style:Sl({color:d(it)(f,40,40),"background-color":d(it)(f,80,90),"border-color":d(it)(f,50,80)})},{default:c(()=>[N(T(d(De)(f)),1)]),_:2},1032,["style"]))),128))]),I("td",null,[n(i,null,{default:c(()=>[N(T(r.row.popu[m]),1)]),_:2},1024)])]))),128))]),(g(!0),v(k,null,B(r.row.waves,(h,m)=>(g(),v("div",{key:m,class:"space-x-1"}))),128))])):pe("",!0)]),_:1})]),_:1},8,["data"])])}}});const Ns=Ye(Ss,[["__scopeId","data-v-607d2849"]]),bs=Object.freeze(Object.defineProperty({__proto__:null,default:Ns},Symbol.toStringTag,{value:"Module"})),xs=J({__name:"DreamWaveEditor",props:mt({wolfList:{}},{modelValue:{}}),emits:mt(["change"],["update:modelValue"]),setup(_,{emit:t}){const e=_,l=Nl(_,"modelValue"),s=t,i=ie(""),o=ie(!1),r=ie(),h=ie(e.wolfList.slice()),m=O=>{l.value.splice(l.value.indexOf(O),1),s("change")},f=()=>{o.value=!0,la(()=>{r.value.focus()})},x=O=>{console.log(O),h.value=O?e.wolfList.filter(w(O)):e.wolfList},w=O=>C=>C.id.toLowerCase().includes(O.toLowerCase())||C.value.includes(O),D=O=>{l.value.push(O),l.value.sort((C,R)=>C.id.localeCompare(R.id)),o.value=!1,i.value="",s("change")};return(O,C)=>{const R=nt,E=ia,S=ye,V=ct;return g(),v("div",null,[I("div",null,[(g(!0),v(k,null,B(l.value,y=>(g(),M(R,{key:y.id,type:"info",effect:"plain",class:"m-0.5",closable:"","disable-transitions":!1,onClose:X=>m(y)},{default:c(()=>[I("ruby",null,[N(T(y.value)+" ",1),I("rt",null,T(y.id),1)])]),_:2},1032,["onClose"]))),128)),d(o)?(g(),M(d(Me),{key:0,ref_key:"InputRef",ref:r,modelValue:d(i),"onUpdate:modelValue":C[0]||(C[0]=y=>$e(i)?i.value=y:null),filterable:"","filter-method":x,class:"inline-block m-0.5",placeholder:"Select",size:"small",onChange:D},{default:c(()=>[(g(!0),v(k,null,B(d(h),y=>(g(),M(S,{key:y.id,value:y},{default:c(()=>[N(T(y.value)+" ",1),n(E,{class:"mx-1",type:"primary"},{default:c(()=>[N("["+T(y.id)+"]",1)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])):(g(),M(V,{key:1,class:"button-new-tag m-0.5",type:"primary",plain:"",size:"small",onClick:f},{default:c(()=>[N(" + ")]),_:1}))])])}}}),ws={class:"dialog-footer"},Cs=J({__name:"dream-design",setup(_){const{toClipboard:t}=ga(),e=ie(!1),l=ie(""),s=ie(!1),i=ie({}),o=ie(""),r=ie(),h=Object.keys(b.$_wolfAtt_Obj).map(R=>({id:R,value:De(R)})),m=[1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100],f=ie(m.map(R=>({key:R,wolf:[],popu:0,popFixed:!1}))),x=(R,E=!1)=>{(!R.popFixed||E)&&(R.popFixed=!1,R.popu=fs(R.wolf.map(S=>S.id)))},w=R=>{R.popu==0?(R.popFixed=!1,x(R)):R.popFixed=!0},D=()=>{const R=JSON.parse(l.value);f.value=m.map(E=>({key:E,wolf:(R.wolf[E]??R.boss[E]??[]).map(S=>({id:S,value:De(S)})),popu:R.popu[E],popFixed:!0})),e.value=!1},O=()=>{s.value=!0;const R={wolf:{},boss:{},popu:{}};for(const E of f.value){const S=E.wolf.map(V=>V.id);R[E.key<10?"wolf":"boss"][E.key]=S,E.key<10?R.wolf[E.key]=S:R.boss[E.key]=S,R.popu[E.key]=E.popu}i.value=R,o.value=JSON.stringify(R)},C=()=>{t(o.value,r.value.$el),wl.success("已复制到剪贴板")};return(R,E)=>{const S=ct,V=Ge,y=Ae,X=We,le=na;return g(),v("div",null,[n(S,{onClick:E[0]||(E[0]=q=>e.value=!0)},{default:c(()=>[N("导入")]),_:1}),n(S,{onClick:O},{default:c(()=>[N("导出")]),_:1}),n(X,{data:d(f),style:{"max-width":"1200px"}},{default:c(()=>[n(V,{prop:"key",label:"Key",width:80,align:"center"}),n(V,{label:"Wolf"},{default:c(q=>[n(xs,{"wolf-list":d(h),modelValue:q.row.wolf,"onUpdate:modelValue":ae=>q.row.wolf=ae,onChange:ae=>x(q.row)},null,8,["wolf-list","modelValue","onUpdate:modelValue","onChange"])]),_:1}),n(V,{label:"Population",width:160,align:"center"},{default:c(q=>[n(y,{modelValue:q.row.popu,"onUpdate:modelValue":ae=>q.row.popu=ae,size:"small",min:0,onChange:ae=>w(q.row),style:{width:"90px"},class:aa({primary:q.row.popFixed})},null,8,["modelValue","onUpdate:modelValue","onChange","class"]),n(S,{icon:q.row.popFixed?d(pa):d(fa),circle:"",size:"small",class:"m-0.5",onClick:ae=>q.row.popFixed?x(q.row,!0):q.row.popFixed=!0},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"]),n(le,{modelValue:d(e),"onUpdate:modelValue":E[3]||(E[3]=q=>$e(e)?e.value=q:null),title:"导出数据"},{footer:c(()=>[I("span",ws,[n(S,{onClick:E[2]||(E[2]=q=>e.value=!1)},{default:c(()=>[N("取消")]),_:1}),n(S,{type:"primary",onClick:D},{default:c(()=>[N(" 确定 ")]),_:1})])]),default:c(()=>[n(d(cl),{type:"textarea",rows:10,modelValue:d(l),"onUpdate:modelValue":E[1]||(E[1]=q=>$e(l)?l.value=q:null),spellcheck:!1},null,8,["modelValue"])]),_:1},8,["modelValue"]),n(le,{modelValue:d(s),"onUpdate:modelValue":E[4]||(E[4]=q=>$e(s)?s.value=q:null),title:"导出数据"},{default:c(()=>[n(d(Aa),{data:d(i),virtual:"",deep:2},null,8,["data"]),n(S,{onClick:C,ref_key:"someRef",ref:r},{default:c(()=>[N("复制到剪贴板")]),_:1},512)]),_:1},8,["modelValue"])])}}});const Rs=Object.freeze(Object.defineProperty({__proto__:null,default:Cs},Symbol.toStringTag,{value:"Module"})),Le=class Le extends Qa{constructor(){super();a(this,"id","");a(this,"skills",{});a(this,"tag");this.tag="BaseUnit"}init(){this.initSkills()}initSkills(){}get data(){return this.m_data}};a(Le,"SKILL_ID","skid"),a(Le,"SKILL_LEVEL","lev"),a(Le,"STATUS_RATE",200),a(Le,"STATUS_TIME",Le.STATUS_RATE/1e3),a(Le,"AOE_SILENCE_RANGE",1e3),a(Le,"AOE_SILENCE_TIME",2);let Be=Le;class Ks extends Be{constructor(){super()}get buildingData(){return this.m_data}get range(){return this.buildingData.range}get skillInfo(){const t=Object.values(this.skills);t.sort((l,s)=>l.index-s.index);const e=t.map(l=>l.skillInfo).filter(l=>l!="").join(`
`);return e==""?this.buildingData.info:e}}class Os extends Be{constructor(e){super();a(this,"damage",0);a(this,"range",0);a(this,"attackType");this.m_data=rl.getOnlyExample().getData(e),this.attackType=sl.EFFECT_TYPE_ALL}get bulletData(){return this.m_data}}const rt=class rt extends Ks{constructor(e){super();a(this,"m_level",0);a(this,"gem",null);a(this,"m_attackType","");this.tag="Tower",e&&(this.m_data=il.getOnlyExample().getData(e),this.initTower()),this.level=1}static fromData(e){const l=new rt(null);return l.m_data=e,l.initTower(),l}get towerData(){return this.m_data}initTower(){this.initSkills()}initSkills(){if(this.skills={},this.towerData.skillPackageId!=""){const e=new Hl(this.towerData.skillPackageId,this.towerData.skillPackageLevel);if(e!=null&&e.skillsPackageData!=null)for(const l of e.skillsPackageData.skillsList){const s=new j(l,e.level,this).getSubClasses();this.skills[s.data.kindId]=s}}if(this.gem){const e=this.gem.gemData.getSkillPackage(this.data.id);if(e!=null&&e.skillsPackageData!=null)for(const l of e.skillsPackageData.skillsList){const s=new j(l,e.level,this).getSubClasses();this.skills[s.data.kindId]=s}this.skills[L.KIND_SCATTER_ATTACK]&&delete this.skills[L.KIND_DIVIDED_ATTACK]}}get color(){return this.gem!=null?this.gem.gemData.color:6316128}get level(){return this.m_level}set level(e){this.m_level=e}get gemLevel(){return this.gem?this.gem.gemData.gemLevel:0}get ability(){const e=this.gemLevel;return this.towerData.isMagicTower?e==0?0:this.m_level*(.8+e/5)*2:this.m_level*(1+e/10)}get power(){const e=this.level,l=b.$_tower_worth_factor,s=this.gemLevel,i=this.valueCostConst(e);return Math.round((i+Math.pow(s,l[0])*l[1])*(l[2]+s/l[3]))}buildValue(e=-1){return e==-1&&(e=this.level),Math.floor(this.towerData.buildValueA+this.towerData.buildValueB*e+this.towerData.buildValueC*e*e)}buildCost(e=-1){return e==-1&&(e=this.level),Math.floor(this.towerData.buildCostA+this.towerData.buildCostB*e+this.towerData.buildCostC*e*e)}valueCost(e=-1){e==-1&&(e=this.level);const l=e*this.towerData.buildCostA+(e*e+e)/2*this.towerData.buildCostB+(e*e*e+e*e*3/2+e/2)/3*this.towerData.buildCostC+this.towerData.buildCost-this.towerData.buildCostA-this.towerData.buildCostB-this.towerData.buildCostC;return Math.round(l)}valueCostConst(e=-1){e==-1&&(e=this.level);const l=e*this.towerData.buildCostAConst+(e*e+e)/2*this.towerData.buildCostBConst+(e*e*e+e*e*3/2+e/2)/3*this.towerData.buildCostCConst+this.towerData.buildCostConst-this.towerData.buildCostAConst-this.towerData.buildCostBConst-this.towerData.buildCostCConst;return Math.round(l)}buffEffect(e=-1){return e==-1&&(e=this.level),this.towerData.buffEffect*e+1}damage(e=-1){let l=0;if(e==-1&&(e=this.level),this.skills[L.KIND_CHANGE_DAMAGE]instanceof Ml){let s=this.skills[L.KIND_CHANGE_DAMAGE];s.isChangeBase()?l=Math.round((s.damageA+s.damageB*e+s.damageC*e*e)*s.damageRate+s.damageAdd):l=Math.round((this.towerData.damageA+this.towerData.damageB*e+this.towerData.damageC*e*e)*s.damageRate+s.damageAdd)}else l=Math.round(this.towerData.damageA+this.towerData.damageB*e+this.towerData.damageC*e*e);return Math.max(l,0)}get range(){let e=0;if(this.skills[L.KIND_CHANGE_RANGE]instanceof kl){let l=this.skills[L.KIND_CHANGE_RANGE];l.isChangeBase()?e=l.range*l.rangeRate+l.rangeAdd:e=this.towerData.range*l.rangeRate+l.rangeAdd}else e=this.towerData.range;return e}get rate(){let e=0;if(this.skills[L.KIND_CHANGE_RATE]instanceof Fl){let l=this.skills[L.KIND_CHANGE_RATE];l.isChangeBase()?e=Math.round(l.rate*l.rateRate):e=Math.round(this.towerData.rate*l.rateRate)}else e=this.towerData.rate;return e}setGem(e){this.gem=e,this.initSkills()}newBullet(){return new Os(this.getBulletId())}getBulletId(){let e=null;return this.skills[L.KIND_CHANGE_BULLET]instanceof yl?(e=this.skills[L.KIND_CHANGE_BULLET],e.bulletId):this.towerData.bulletId}getInfoHtml(){return Kt(this.skillInfo,this.color,!1,"14px")}};a(rt,"TOWER","tower"),a(rt,"GEM","gem");let Et=rt;const Ps={class:"space-x-2"},ys=J({__name:"TowerDataForm",props:{tower:{}},setup(_){const t=_;me({});const e=ie(b.$_towerAtt_Obj.shaota),l=s=>{t.tower.m_data=new El(s)};return(s,i)=>{const o=ye,r=Me,h=je,m=Ae,f=Xe,x=dl;return g(),M(x,null,{default:c(()=>[n(f,{"label-width":"100px"},{default:c(()=>[n(h,{label:"原型"},{default:c(()=>[n(r,{modelValue:d(e),"onUpdate:modelValue":i[0]||(i[0]=w=>$e(e)?e.value=w:null),"value-key":"id",onChange:l},{default:c(()=>[(g(!0),v(k,null,B(d(b).$_towerAtt_Obj,(w,D)=>(g(),M(o,{key:D,label:w.name,value:w},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(h,{label:"等级"},{default:c(()=>[n(m,{modelValue:s.tower.m_level,"onUpdate:modelValue":i[1]||(i[1]=w=>s.tower.m_level=w)},null,8,["modelValue"])]),_:1}),n(h,{label:"damage"},{default:c(()=>[I("div",Ps,[I("span",null,[N(" a: "),n(m,{modelValue:s.tower.towerData.damageA,"onUpdate:modelValue":i[2]||(i[2]=w=>s.tower.towerData.damageA=w),"controls-position":"right",step:d(ke)(d(e).damage.a),style:{width:"100px"}},null,8,["modelValue","step"])]),I("span",null,[N(" b: "),n(m,{modelValue:s.tower.towerData.damageB,"onUpdate:modelValue":i[3]||(i[3]=w=>s.tower.towerData.damageB=w),"controls-position":"right",step:d(ke)(d(e).damage.b),style:{width:"100px"}},null,8,["modelValue","step"])]),I("span",null,[N(" c: "),n(m,{modelValue:s.tower.towerData.damageC,"onUpdate:modelValue":i[4]||(i[4]=w=>s.tower.towerData.damageC=w),"controls-position":"right",step:d(ke)(d(e).damage.c),style:{width:"100px"}},null,8,["modelValue","step"])])])]),_:1}),n(h,{label:"rate"},{default:c(()=>[n(m,{modelValue:s.tower.towerData.rate,"onUpdate:modelValue":i[5]||(i[5]=w=>s.tower.towerData.rate=w),step:d(ke)(d(e).rate)},null,8,["modelValue","step"])]),_:1}),n(h,{label:"range"},{default:c(()=>[n(m,{modelValue:s.tower.towerData.range,"onUpdate:modelValue":i[6]||(i[6]=w=>s.tower.towerData.range=w),step:d(ke)(d(e).range)},null,8,["modelValue","step"])]),_:1}),n(h,{label:"buffEffect"},{default:c(()=>[n(m,{modelValue:s.tower.towerData.buffEffect,"onUpdate:modelValue":i[7]||(i[7]=w=>s.tower.towerData.buffEffect=w),step:d(ke)(d(e).buffEffect)},null,8,["modelValue","step"])]),_:1})]),_:1})]),_:1})}}}),Ms=["innerHTML"],ks=J({__name:"TowerInfo",props:{tower:{}},setup(_){return(t,e)=>{const l=je,s=Xe,i=dl;return g(),M(i,null,{default:c(()=>[n(s,{"label-width":"80px"},{default:c(()=>[n(l,{label:"damage"},{default:c(()=>[N(T(t.tower.damage()),1)]),_:1}),n(l,{label:"rate"},{default:c(()=>[N(T(t.tower.rate),1)]),_:1}),n(l,{label:"range"},{default:c(()=>[N(T(t.tower.range),1)]),_:1}),n(l,{label:"简介"},{default:c(()=>[I("div",{innerHTML:t.tower.getInfoHtml(),style:{"line-height":"1.5em"}},null,8,Ms)]),_:1})]),_:1})]),_:1})}}}),Fs={key:0,class:"ml-2 space-x-2"},Us=J({__name:"TowerSkillItem",props:mt({tower:{}},{modelValue:{required:!0}}),emits:mt(["update:model-value"],["update:modelValue"]),setup(_,{emit:t}){const e=_,l=Nl(_,"modelValue"),s=ie(),i=()=>{s.value=b.skillTemplates[l.value.kindId],l.value.params=s.value.params.slice()};return gt(()=>l.value.kindId,(o,r)=>{var h;if(r!=o){delete e.tower.skills[r];const m=new j(s.value.id,((h=e.tower.skills[o])==null?void 0:h.level)??50,e.tower).getSubClasses();m.m_data=new L(l.value),e.tower.skills[o]=m}}),gt(l,(o,r)=>{e.tower.skills[o.kindId].m_data=new L(o)},{deep:!0}),sa(()=>{l.value.kindId&&delete e.tower.skills[l.value.kindId]}),(o,r)=>{const h=ye,m=Me,f=cl,x=Ae;return g(),v("div",null,[n(m,{modelValue:l.value.kindId,"onUpdate:modelValue":[r[0]||(r[0]=w=>l.value.kindId=w),i]},{default:c(()=>[(g(!0),v(k,null,B(Object.keys(d(b).skillTemplates),w=>(g(),v(k,{key:w},[w in o.tower.skills?pe("",!0):(g(),M(h,{key:0,label:w,value:w},null,8,["label","value"]))],64))),128))]),_:1},8,["modelValue"]),d(s)?(g(),v("span",Fs,[(g(!0),v(k,null,B(d(s).params,(w,D)=>(g(),v(k,null,[typeof w=="string"?(g(),M(f,{key:0,modelValue:l.value.params[D],"onUpdate:modelValue":O=>l.value.params[D]=O,size:"small",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])):(g(),M(x,{key:1,modelValue:l.value.params[D],"onUpdate:modelValue":O=>l.value.params[D]=O,size:"small","controls-position":"right",step:d(ke)(w),style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue","step"]))],64))),256))])):pe("",!0)])}}}),Vs=J({__name:"TowerSkillTable",props:{tower:{}},setup(_){const t=me([]),e=ie(),l=()=>{t.push({data:{kindId:"",params:[]}})},s=(i,o)=>{t.splice(i,1)};return(i,o)=>{const r=Ge,h=Ae,m=ct;return g(),v("div",null,[n(d(We),{ref_key:"skillTableRef",ref:e,data:d(t),stripe:"",border:"","table-layout":"auto",style:{"font-size":"small"}},{default:c(()=>[n(r,{label:"Skill","header-align":"center"},{default:c(f=>[n(Us,{tower:i.tower,modelValue:f.row.data,"onUpdate:modelValue":x=>f.row.data=x},null,8,["tower","modelValue","onUpdate:modelValue"])]),_:1}),n(r,{label:"Level","header-align":"center",width:130},{default:c(f=>[i.tower.skills[f.row.data.kindId]?(g(),M(h,{key:0,modelValue:i.tower.skills[f.row.data.kindId].level,"onUpdate:modelValue":x=>i.tower.skills[f.row.data.kindId].level=x,style:{width:"120px"}},null,8,["modelValue","onUpdate:modelValue"])):pe("",!0)]),_:1}),n(r,{label:"Info","header-align":"center"},{default:c(f=>{var x;return[N(T((x=i.tower.skills[f.row.data.kindId])==null?void 0:x.skillInfo),1)]}),_:1}),n(r,{label:"操作",width:100,align:"center"},{default:c(f=>[n(m,{size:"small",type:"danger",onClick:x=>s(f.$index,f.row)},{default:c(()=>[N(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),n(m,{onClick:l},{default:c(()=>[N("新增")]),_:1})])}}}),$s=J({__name:"tower-design",setup(_){const t=me(new Et(null));return t.m_data=new El(b.$_towerAtt_Obj.shaota),(e,l)=>{const s=Cl,i=Rl;return g(),v(k,null,[n(i,{gutter:20},{default:c(()=>[n(s,{span:12},{default:c(()=>[n(ys,{tower:d(t)},null,8,["tower"])]),_:1}),n(s,{span:12},{default:c(()=>[n(ks,{tower:d(t)},null,8,["tower"])]),_:1})]),_:1}),n(Vs,{tower:d(t),class:"mt-2"},null,8,["tower"])],64)}}}),Bs=Object.freeze(Object.defineProperty({__proto__:null,default:$s},Symbol.toStringTag,{value:"Module"}));class Hs extends dt{constructor(t){super(),this.m_data=al.getOnlyExample().getData(t)}get gemData(){return this.m_data}}const Gs=["innerHTML"],Ws=I("p",null,"注：升级经验为塔下一级的 buildValue 值",-1),js=J({__name:"towers",setup(_){const t=me({isDefendMap:!1,towerId:"shaota",gemId:"",level:1,buildFrom:0,buildTo:1,buildPower:50}),e=W.map(b.$_towerAtt_Obj,(r,h)=>[r.name,h]),l=W.chain(b.$_global_properties.gem).toPairs().sortBy(r=>Number(Math.abs(r[1].index))).map(r=>[`${r[1].name} [${r[1].index}]`,r[0]]).value(),s=G(()=>{const r=new Et(t.towerId);return r.level=t.level,t.gemId!==""&&r.setGem(new Hs(t.gemId)),r}),i=()=>{ee.currentMap=new ee(t.isDefendMap?ee.DEFEND_MAP_1:ee.ENDLESS_MAP_1)},o=G(()=>{let r=0;if(t.buildFrom>t.buildTo)return NaN;for(let h=t.buildFrom+1;h<=t.buildTo;h++)r+=s.value.buildValue(h);return Math.round(r/t.buildPower)});return(r,h)=>{const m=ra,f=je,x=ye,w=Me,D=Cl,O=Rl,C=Ae,R=Xe;return g(),M(R,{model:d(t),"label-width":"120px"},{default:c(()=>[n(f,{label:"是否为防线"},{default:c(()=>[n(m,{modelValue:d(t).isDefendMap,"onUpdate:modelValue":h[0]||(h[0]=E=>d(t).isDefendMap=E),onChange:i},null,8,["modelValue"])]),_:1}),n(O,null,{default:c(()=>[n(D,{span:12},{default:c(()=>[n(f,{label:"塔"},{default:c(()=>[n(w,{modelValue:d(t).towerId,"onUpdate:modelValue":h[1]||(h[1]=E=>d(t).towerId=E)},{default:c(()=>[(g(!0),v(k,null,B(d(e),([E,S])=>(g(),M(x,{key:S,label:E,value:S},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),n(D,{span:12},{default:c(()=>[n(f,{label:"宝石"},{default:c(()=>[n(w,{modelValue:d(t).gemId,"onUpdate:modelValue":h[2]||(h[2]=E=>d(t).gemId=E)},{default:c(()=>[n(x,{label:"无",value:""}),(g(!0),v(k,null,B(d(l),([E,S])=>(g(),M(x,{key:S,label:E,value:S},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(O,null,{default:c(()=>[n(D,{span:8},{default:c(()=>[n(f,{label:"等级"},{default:c(()=>[n(C,{modelValue:d(t).level,"onUpdate:modelValue":h[3]||(h[3]=E=>d(t).level=E),min:1},null,8,["modelValue"])]),_:1})]),_:1}),n(D,{span:8},{default:c(()=>[n(f,{label:"等级上限"},{default:c(()=>[I("label",null,T(d(s).towerData.levelMax),1)]),_:1})]),_:1}),n(D,{span:8},{default:c(()=>[n(f,{label:"升级经验"},{default:c(()=>[I("label",null,T(d(s).buildValue(d(s).level+1)),1)]),_:1})]),_:1})]),_:1}),n(O,null,{default:c(()=>[n(D,{span:8},{default:c(()=>[n(f,{label:"攻击力"},{default:c(()=>[I("label",null,T(d(s).damage()),1)]),_:1})]),_:1}),n(D,{span:8},{default:c(()=>[n(f,{label:"攻击频率"},{default:c(()=>[I("label",null,T(d(s).rate),1)]),_:1})]),_:1}),n(D,{span:8},{default:c(()=>[n(f,{label:"攻击范围"},{default:c(()=>[I("label",null,T(d(s).range),1)]),_:1})]),_:1})]),_:1}),n(f,{label:"简介"},{default:c(()=>[I("div",{innerHTML:d(s).getInfoHtml(),style:{"line-height":"1.5em"}},null,8,Gs)]),_:1}),n(O,null,{default:c(()=>[n(D,{span:8},{default:c(()=>[n(f,{label:"ability"},{default:c(()=>[I("label",null,T(d(s).ability.toFixed(1)),1)]),_:1})]),_:1}),n(D,{span:8},{default:c(()=>[n(f,{label:"power"},{default:c(()=>[I("label",null,T(d(s).power),1)]),_:1})]),_:1}),n(D,{span:8},{default:c(()=>[n(f,{label:"buffEffect"},{default:c(()=>[I("label",null,T(d(s).buffEffect().toFixed(1)),1)]),_:1})]),_:1})]),_:1}),n(O,null,{default:c(()=>[n(D,{span:8},{default:c(()=>[n(f,{label:"buildValue"},{default:c(()=>[I("label",null,T(d(s).buildValue()),1)]),_:1})]),_:1}),n(D,{span:8},{default:c(()=>[n(f,{label:"buildCost"},{default:c(()=>[I("label",null,T(d(s).buildCost()),1)]),_:1})]),_:1}),n(D,{span:8},{default:c(()=>[n(f,{label:"valueCost"},{default:c(()=>[I("label",null,T(d(s).valueCost()),1)]),_:1})]),_:1})]),_:1}),I("div",null,[n(f,{label:"升级计算",style:{"margin-bottom":"0 !important"}},{default:c(()=>[N(" 从 "),n(C,{modelValue:d(t).buildFrom,"onUpdate:modelValue":h[4]||(h[4]=E=>d(t).buildFrom=E),size:"small","controls-position":"right",style:{width:"5em",margin:"0.5em"}},null,8,["modelValue"]),N(" 级到 "),n(C,{modelValue:d(t).buildTo,"onUpdate:modelValue":h[5]||(h[5]=E=>d(t).buildTo=E),size:"small","controls-position":"right",style:{width:"5em",margin:"0.5em"}},null,8,["modelValue"]),N(" 级， 苦工总力量 "),n(C,{modelValue:d(t).buildPower,"onUpdate:modelValue":h[6]||(h[6]=E=>d(t).buildPower=E),size:"small","controls-position":"right",style:{width:"8em",margin:"0.5em"}},null,8,["modelValue"])]),_:1}),n(f,{style:{"margin-bottom":"0 !important"}},{default:c(()=>[N(" 需要时间："),I("label",null,T(d(ts)(d(o))),1)]),_:1}),Ws])]),_:1},8,["model"])}}}),Xs=Object.freeze(Object.defineProperty({__proto__:null,default:js},Symbol.toStringTag,{value:"Module"})),Ys=_=>(ol("data-v-aabdd49a"),_=_(),ul(),_),zs={class:"chart-area"},qs=Ys(()=>I("h2",{style:{"text-align":"center"}},"狼出现频率（按数量，供参考）",-1)),Js=J({__name:"WaveDistribChart",props:{mid:{},height:{default:600},width:{default:600}},setup(_){hl([ml,Ia,gl,pl,fl,Ta,Al,La]);const t=_,e=G(()=>Sa[t.mid]),l=G(()=>[b.$_map_Obj[t.mid].name,...b.$_map_Obj[t.mid].wolf_proportion.map(r=>De(r[1]))]),s=G(()=>W.range(e.value.all.length)),i=G(()=>W.zip(l.value,[e.value.all,...e.value.each]).map((r,h)=>({title:r[0],pdf:r[1],cdf:[...$a(r[1])]}))),o=G(()=>({color:i.value.flatMap(r=>[it(r.title,70,50),it(r.title,50,80)]),tooltip:{trigger:"axis",valueFormatter:r=>es(r,6)},title:i.value.map((r,h)=>({text:r.title,left:"center",textVerticalAlign:"middle",top:t.height*((h+.5)/i.value.length)-5,z:-1,textStyle:{fontSize:t.height/i.value.length*.4,color:"#ccc"}})),xAxis:i.value.map((r,h)=>({gridIndex:h,type:"category",axisTick:{alignWithLabel:!0},data:s.value})),yAxis:i.value.flatMap((r,h)=>[{gridIndex:h,type:"value",alignTicks:!0,axisLine:{show:!0},axisTick:{show:!0,inside:!0,length:3}},{gridIndex:h,type:"value",position:"right",min:0,max:1,interval:.2,alignTicks:!0,axisLine:{show:!0},axisTick:{show:!0,inside:!0,length:3}}]),grid:i.value.map((r,h)=>({top:t.height*(h/i.value.length)+10,bottom:t.height*(1-(h+1)/i.value.length)+20})),series:i.value.flatMap((r,h)=>[{xAxisIndex:h,yAxisIndex:h*2,type:"bar",barWidth:"90%",data:r.pdf},{xAxisIndex:h,yAxisIndex:h*2+1,type:"line",smooth:!0,data:r.cdf}])}));return(r,h)=>(g(),v("div",zs,[qs,n(d(_l),{class:"chart",option:d(o)},null,8,["option"])]))}});const Zs=Ye(Js,[["__scopeId","data-v-aabdd49a"]]),Qs=J({__name:"WolfNumberChart",props:{data:{},max:{}},setup(_){hl([pl,ml,gl,fl,Al]);const t=_,e=G(()=>({color:["#C00000"],xAxis:{type:"value",interval:1,axisLine:{show:!0,lineStyle:{width:1,type:"solid"}},max:t.max},yAxis:{type:"category",axisTick:{alignWithLabel:!0},axisLabel:{fontSize:14},data:t.data.map(l=>l.name)},grid:{left:100,top:0,bottom:20},series:{type:"bar",barWidth:"60%",label:{show:!0,position:"right"},showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)"},data:t.data.map(l=>l.num)}}));return(l,s)=>(g(),M(d(_l),{class:"chart",option:d(e)},null,8,["option"]))}});const ei=Ye(Qs,[["__scopeId","data-v-1d3eb83e"]]),Xl=_=>(ol("data-v-c8536048"),_=_(),ul(),_),ti=Xl(()=>I("h3",null,"波工具",-1)),li=Xl(()=>I("label",null,"下表为预留量",-1)),ai=J({__name:"WaveTool",props:{mid:{},mapMonsterData:{}},setup(_){const t=_,e=me({count:0,avgHp:"",reservation:[0,0,0,0,0,0,0],extra:"",result:"",resultRaw:""});let l=me([]);const s=()=>{e.reservation.fill(0)},i=()=>{let o=Es(t.mid,[...e.reservation]);if(!o){wl.error("预留量不合法，请重新输入！");return}let[r,h]=o;e.extra&&(r=W.shuffle(r.concat(e.extra.split(",").map(m=>m.trim())))),e.resultRaw=`[${r.map(m=>`"${m}"`).join(",")}]`,e.result=De(r).join(","),l=h.map(m=>({name:De(m[0]),num:m[1]})),e.count=W.sumBy(h,m=>m[1])};return(o,r)=>{const h=ct,m=Ae,f=cl,x=dl;return g(),M(x,{id:"wave-tool"},{default:c(()=>[ti,n(h,{onClick:i},{default:c(()=>[N("随机生成波")]),_:1}),I("span",null,[N(" 共 "),n(m,{modelValue:d(e).count,"onUpdate:modelValue":r[0]||(r[0]=w=>d(e).count=w)},null,8,["modelValue"]),N(" 只狼，平均血量 "),n(f,{modelValue:d(e).avgHp,"onUpdate:modelValue":r[1]||(r[1]=w=>d(e).avgHp=w),modelModifiers:{number:!0},style:{width:"100px"}},null,8,["modelValue"])]),n(h,null,{default:c(()=>[N("组成推算")]),_:1}),I("div",null,[I("p",null,[li,n(h,{size:"small",onClick:s},{default:c(()=>[N("重置")]),_:1})]),I("table",null,[I("tbody",null,[I("tr",null,[(g(!0),v(k,null,B(o.mapMonsterData,w=>(g(),v("td",{key:w.id},T(w.name),1))),128))]),I("tr",null,[(g(!0),v(k,null,B(o.mapMonsterData,(w,D)=>(g(),v("td",{key:w.id},[n(m,{modelValue:d(e).reservation[D],"onUpdate:modelValue":O=>d(e).reservation[D]=O,size:"small","controls-position":"right",min:0},null,8,["modelValue","onUpdate:modelValue"])]))),128))])])]),I("p",null,[N(" 额外："),n(f,{modelValue:d(e).extra,"onUpdate:modelValue":r[2]||(r[2]=w=>d(e).extra=w),style:{width:"580px"},placeholder:"多个请用半角逗号分隔",spellcheck:"false"},null,8,["modelValue"])]),I("p",null,[N("波："),n(f,{modelValue:d(e).resultRaw,"onUpdate:modelValue":r[3]||(r[3]=w=>d(e).resultRaw=w),style:{width:"600px"},spellcheck:"false"},null,8,["modelValue"])]),I("p",null,[N("波："),n(f,{modelValue:d(e).result,"onUpdate:modelValue":r[4]||(r[4]=w=>d(e).result=w),style:{width:"600px"},spellcheck:"false"},null,8,["modelValue"])])]),n(ei,{data:d(l),max:10},null,8,["data"])]),_:1})}}});const si=Ye(ai,[["__scopeId","data-v-c8536048"]]),ii={class:"space-x-8"},ni={class:"space-x-4"},ri=I("span",null,"（假设每波+2且不引狼）",-1),oi=J({__name:"umapdetail",setup(_){const t=W.chain(b.$_map_Obj).map((E,S)=>W.extend(E,{id:S})).toArray().sortBy("index").value(),e=W.chain(b.$_wolfAtt_Obj).toPairs().map(E=>{let S=E[1].name;return{value:E[0],label:S.includes("^")?S.substring(S.indexOf("^")+1):S}}).sortBy("id").value(),l=me({mid:"m1",mid2:"",wid:"dahuil",score:0,diff:1}),s=G(()=>b.$_map_Obj[l.mid]),i=G(()=>ee.getMapData(l.mid)),o=G(()=>l.mid2===""?i.value:ee.getMapData(l.mid2)),r=G(()=>i.value.monsterList.map(E=>fe.getOnlyExample().getData(E))),h=G(()=>fe.getOnlyExample().getData(l.wid)),m=E=>E.map(S=>{let V=b.$_wolfAtt_Obj[S[1]];return{id:S[1],prob:S[0],name:V.name,pop:V.pop}}),f=E=>E?E.map(S=>{let V=b.$_wolfAtt_Obj[S[1]];return{id:S[1],prob:S[0],name:V.name,diff:parseFloat(S[2])}}):[],x=G(()=>o.value.getDifficultyLevel(l.score)),w=G(()=>h.value.getHpMax(x.value,l.diff)),D=G(()=>r.value.map(E=>({name:E.name,value:E.getHpMax(x.value,l.diff)}))),O=E=>{const S=i.value.populationMax;return Math.round((2+1.07*S)*Math.pow(E/.39,2/3))},C=E=>{const S=i.value.populationMax;return Math.round((3.5+.14*S)*Math.pow(E/.39,2/3))},R=G(()=>{let E=0,S=0;for(let V=0;V<=i.value.scoreMax;V+=2){let y=Math.sqrt(i.value.hardA+i.value.hardB*V);E+=O(y),S+=C(y)}return{gold:E,exp:S}});return(E,S)=>{const V=ye,y=Me,X=nt,le=je,q=oa,ae=Ae,St=vt("vue-latex"),ql=Xe;return g(),v(k,null,[n(ql,{model:d(l),"label-width":"120px"},{default:c(()=>[n(le,{label:"地图"},{default:c(()=>[n(y,{modelValue:d(l).mid,"onUpdate:modelValue":S[0]||(S[0]=U=>d(l).mid=U)},{default:c(()=>[(g(!0),v(k,null,B(d(t),U=>(g(),M(V,{key:U.id,label:`${U.id} ${U.name}`,value:U.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),n(X,{effect:"light"},{default:c(()=>[N(" 难度系数："+T(d(i).hardA)+","+T(d(i).hardB),1)]),_:1}),n(X,{effect:"light"},{default:c(()=>[N(" Population："+T(d(i).populationMax),1)]),_:1})]),_:1}),n(le,{label:"引狼到"},{default:c(()=>[n(y,{modelValue:d(l).mid2,"onUpdate:modelValue":S[1]||(S[1]=U=>d(l).mid2=U),clearable:""},{default:c(()=>[n(V,{label:"无",value:""}),(g(!0),v(k,null,B(d(t),U=>(g(),M(V,{key:U.id,label:`${U.id} ${U.name}`,value:U.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(le,{label:"该地图的狼"},{default:c(()=>[(g(!0),v(k,null,B(m(d(s).wolf_proportion),U=>(g(),M(X,{key:U.id,type:"success",class:"mx-1 tag-button",effect:"light",onClick:Jl=>d(l).wid=U.id},{default:c(()=>[I("sub",null,T(U.prob),1),N(" "+T(U.name)+" ",1),I("sup",null,T(U.pop),1)]),_:2},1032,["onClick"]))),128))]),_:1}),"random_boss"in d(s)?(g(),M(le,{key:0,label:"随机 Boss"},{default:c(()=>[(g(!0),v(k,null,B(f(d(s).random_boss),U=>(g(),M(X,{key:U.id,type:"success",class:"mx-1 tag-button",effect:"light",onClick:Jl=>{d(l).wid=U.id,d(l).diff=U.diff}},{default:c(()=>[I("sub",null,T(U.prob),1),N(" "+T(U.name)+" ",1),I("sub",null,T(U.diff),1)]),_:2},1032,["onClick"]))),128))]),_:1})):pe("",!0),n(le,{label:"狼"},{default:c(()=>[n(q,{modelValue:d(l).wid,"onUpdate:modelValue":S[2]||(S[2]=U=>d(l).wid=U),options:d(e)},null,8,["modelValue","options"]),n(X,{effect:"light"},{default:c(()=>[N(" 血量系数："+T(d(h).hpMaxA)+","+T(d(h).hpMaxB)+","+T(d(h).hpMaxC),1)]),_:1})]),_:1}),n(le,{label:"进度"},{default:c(()=>[n(ae,{modelValue:d(l).score,"onUpdate:modelValue":S[3]||(S[3]=U=>d(l).score=U),min:0},null,8,["modelValue"]),n(X,{effect:"light",class:"tag-button",onClick:S[4]||(S[4]=U=>d(l).score=d(o).scoreMax)},{default:c(()=>[N(" 通关进度："+T(d(o).scoreMax),1)]),_:1})]),_:1}),n(le,{label:"难度"},{default:c(()=>[n(y,{modelValue:d(l).diff,"onUpdate:modelValue":S[5]||(S[5]=U=>d(l).diff=U)},{default:c(()=>[n(V,{value:.8,label:"小菜一碟"}),n(V,{value:.9,label:"轻而易举"}),n(V,{value:1,label:"势均力敌"}),n(V,{value:1.1,label:"有惊无险"}),n(V,{value:1.2,label:"稍有难度"}),n(V,{value:1.3,label:"困难重重"})]),_:1},8,["modelValue"])]),_:1}),n(le,null,{default:c(()=>[I("div",ii,[I("span",null,[N(" 等级： "),n(St,{expression:`L(x)=\\sqrt{h_a + h_b x}=${d(x).toFixed(2)}`},null,8,["expression"])]),I("span",null,"最大血量："+T(d(w)),1)])]),_:1}),n(le,null,{default:c(()=>[N(" 银币： "),n(St,{expression:`G(x) = (2+1.07p)(\\frac{L(x)}{0.39})^{2/3} = ${O(d(x))}`},null,8,["expression"])]),_:1}),n(le,null,{default:c(()=>[N(" 经验： "),n(St,{expression:`E(x) = (3.5+0.14p)(\\frac{L(x)}{0.39})^{2/3} = ${C(d(x))}`},null,8,["expression"])]),_:1}),n(le,null,{default:c(()=>[I("div",ni,[I("span",null,"总银币："+T(d(R).gold),1),I("span",null,"总经验："+T(d(R).exp),1),ri])]),_:1}),n(Wl,{"hp-data":d(D)},null,8,["hp-data"])]),_:1},8,["model"]),n(si,{mid:d(l).mid,mapMonsterData:d(r)},null,8,["mid","mapMonsterData"]),n(Zs,{mid:d(l).mid,width:600,height:600},null,8,["mid"])],64)}}});const ui=Object.freeze(Object.defineProperty({__proto__:null,default:oi},Symbol.toStringTag,{value:"Module"})),ci=I("p",null,"前排解释：",-1),di=I("p",null,"狼的等级随进度增加而增加。难度系数 hardA 影响初始狼等级，hardB 影响等级增长速率。",-1),_i=I("p",null,"population 影响一波狼的容量。每只狼都会占用一定容量。",-1),hi=I("p",null,"不同随机boss有出现权重。出现率、难度、奖励水平是相对应的，难的比较稀有，奖励也会比较好。",-1),mi=J({__name:"umaps",setup(_){const t=W.map(b.$_map_Obj,(s,i)=>W.extend(s,{id:i})),e=(s,i)=>{let o=s.need_lev||0,r=i.need_lev||0;return o-r},l=s=>s.map(i=>{const o=fe.getOnlyExample().getData(i[1]);return{prob:i[0],name:o.name,pop:o.population}});return(s,i)=>{const o=Ge,r=nt,h=We;return g(),v(k,null,[ci,di,_i,hi,n(h,{data:d(t),"default-sort":{prop:"index",order:"ascending"},"table-layout":"auto",stripe:"","header-cell-style":{"text-align":"center"},height:"600px",style:{width:"100%","font-size":"80%"},class:"testbox"},{default:c(()=>[n(o,{prop:"index",label:"index",sortable:"",align:"center",fixed:"",width:"70"}),n(o,{prop:"id",label:"id",sortable:"",align:"center",fixed:"",width:"80"}),n(o,{prop:"name",label:"name",sortable:"",align:"center",fixed:"",width:"80"}),n(o,{prop:"pass_score",label:"scoreMax",sortable:"",align:"center"}),n(o,{label:"hardnessFactor"},{default:c(()=>[n(o,{prop:"yield_val",label:"hardA",sortable:"",align:"center"}),n(o,{prop:"hard_ness",label:"hardB",sortable:"",align:"center"})]),_:1}),n(o,{prop:"pop_max",label:"populationMax",sortable:"",align:"center"}),n(o,{prop:"interval",label:"unkennelDelay",sortable:"",align:"center"}),n(o,{prop:"interval_rule",label:"unkennelRule",sortable:"",align:"center"}),n(o,{prop:"teleport_rule",label:"teleportRule",sortable:"",align:"center"}),n(o,{prop:"need_lev",label:"needLevel",sortable:"","sort-method":e,align:"center"}),n(o,{prop:"pass_by",label:"passBy",align:"center"},{default:c(m=>[N(T(m.row.pass_by.map(f=>d(b).$_map_Obj[f].name).join(", ")),1)]),_:1}),n(o,{prop:"wolf_proportion",label:"monsterList","cell-style":{"text-align":"left"}},{default:c(m=>[(g(!0),v(k,null,B(l(m.row.wolf_proportion),f=>(g(),M(r,{key:f.prob,class:"ml-2"},{default:c(()=>[I("sub",null,T(f.prob),1),N(" "+T(f.name)+" ",1),I("sup",null,T(f.pop),1)]),_:2},1024))),128))]),_:1})]),_:1},8,["data"])],64)}}});const gi=Object.freeze(Object.defineProperty({__proto__:null,default:mi},Symbol.toStringTag,{value:"Module"})),pi=J({__name:"user",setup(_){const t=me({level:1}),e=G(()=>((2*(t.level+1)+3)*(t.level+1)+4)*(t.level+1)+20),l=G(()=>Math.round((.015*t.level+.8)*t.level+2)),s=G(()=>Math.floor(t.level/4+1)),i=G(()=>(t.level+7)*l.value);return(o,r)=>{const h=Ae,m=je,f=Xe;return g(),M(f,{model:d(t),"label-width":"120px"},{default:c(()=>[n(m,{label:"等级"},{default:c(()=>[n(h,{modelValue:d(t).level,"onUpdate:modelValue":r[0]||(r[0]=x=>d(t).level=x),min:1},null,8,["modelValue"])]),_:1}),n(m,{label:"升级经验"},{default:c(()=>[I("label",null,T(d(e)),1)]),_:1}),n(m,{label:"力量"},{default:c(()=>[I("label",null,T(d(l)),1)]),_:1}),n(m,{label:"连升等级"},{default:c(()=>[I("label",null,T(d(s)),1)]),_:1}),n(m,{label:"苦工价格"},{default:c(()=>[I("label",null,T(d(i)),1)]),_:1})]),_:1},8,["model"])}}}),fi=Object.freeze(Object.defineProperty({__proto__:null,default:pi},Symbol.toStringTag,{value:"Module"})),st=class st extends Be{constructor(e,l=1,s=1,i=0){super();a(this,"index",0);a(this,"m_level",0);a(this,"exp",0);a(this,"hp",0);a(this,"hpMax",0);a(this,"hpRate");a(this,"skillList",[]);this.tag="Monster",this.updateData(e),this.hpRate=s,this.updateLevelExp(l,i),this.index=st.COUNT++}updateData(e){e==""&&(e="dahuil");let l=e.indexOf("|");l!=-1&&(e=e.slice(0,l)),this.m_data=fe.getOnlyExample().getData(e),this.m_data==null&&(this.m_data=fe.getOnlyExample().getData("dahuil"))}createSkills(e){return e.map(l=>new ce(l[Be.SKILL_ID],l[Be.SKILL_LEVEL],this).getSubClasses())}initSkills(){this.skills={};const e=this.data.skills;if(e!=null){this.skillList=this.createSkills(e);for(const l of this.skillList)this.skills[l.data.kindId]=l}}conflictSkillList(e){const l=[];if(e==null)return[];const s=b.$_conflict_skill_kind,i=e.data.kindId;this.skills[i]&&l.push(ce.getKindName(i));for(const o of s)if(o.indexOf(i)!=-1)for(let r=0;r<o.length;r++)i!=o[r]&&this.skills[o[r]]&&l.push(ce.getKindName(o[r]));return l}getSkillById(e){let l,s=null;for(l in this.skills)if(s=this.skills[l],s.data.id==e)return s;return null}updateLevelExp(e=0,l=0){this.level=e,this.exp=l}get allSkillsScore(){let e=1;for(const l of this.skillList)l.enabled&&(e*=this.getSkillScore(l.data.id,l.level));return e}getSkillScore(e,l){let s=null,i=b.$_skill_grade_score,o=e.indexOf("_");return e.indexOf("_")==-1?1:(s=e.slice(o+1,e.length),i[s]&&i[s][String(l)]?i[s][String(l)]:1)}get levelMax(){return b.$_camp_wolf_lv_max}get expMax(){let e=this.m_level+1;return Math.round(this.monsterData.expMaxA+this.monsterData.expMaxB*e+this.monsterData.expMaxC*e*e+this.monsterData.expMaxD*e*e*e)}get level(){return this.m_level}set level(e){this.m_level=Math.max(Math.min(e,this.levelMax),0),ee.currentMap&&ee.currentMap&&(this.hpMax=Math.floor((this.monsterData.hpMaxA+this.monsterData.hpMaxB*this.m_level+this.monsterData.hpMaxC*this.m_level*this.m_level)*this.hpRate)),this.hpMax<=1&&(this.hpMax=1)}refreshLevel(){this.hpMax=Math.floor((this.monsterData.hpMaxA+this.monsterData.hpMaxB*this.m_level+this.monsterData.hpMaxC*this.m_level*this.m_level)*this.hpRate*1),this.hpMax<=1&&(this.hpMax=1)}get monsterData(){return this.m_data}get power(){let e=b.$_wolf_worth_factor,l=this.hpMax,s=this.monsterData.speedBase,i=this.allSkillsScore;return Math.round(l*s*i*e[2])}get skillInfo(){if(this.skills==null)return"";const e=Object.values(this.skills);return e.sort((l,s)=>l.index-s.index),e.map(l=>l.skillInfo).join("")}};a(st,"MONSTER_SAY_ARRAY",[u.getLanguageStr(1250),u.getLanguageStr(1251),u.getLanguageStr(1252),u.getLanguageStr(1253),u.getLanguageStr(1254),u.getLanguageStr(1255),u.getLanguageStr(1256),u.getLanguageStr(1257),u.getLanguageStr(1258),u.getLanguageStr(1259)]),a(st,"WEIGHTILY_SIZE",487500),a(st,"COUNT",0);let ut=st;const Il=W.sortBy(W.map(b.$_wolfAtt_Obj,(_,t)=>({id:t,name:_.name,label:`${De(t)} [${t}]`})),"id"),Yl=Il.filter(_=>_.name.startsWith("camp_")),zl=Il.filter(_=>_.id.startsWith("D_")),Ai=W.difference(Il,Yl,zl),Ei=J({__name:"WolfSelect",setup(_){return(t,e)=>{const l=ye,s=ua,i=Me;return g(),M(i,null,{default:c(()=>[n(s,{label:"前线"},{default:c(()=>[(g(!0),v(k,null,B(d(Ai),o=>(g(),M(l,{key:o.id,label:o.label,value:o.id},null,8,["label","value"]))),128))]),_:1}),n(s,{label:"防线"},{default:c(()=>[(g(!0),v(k,null,B(d(Yl),o=>(g(),M(l,{key:o.id,label:o.label,value:o.id},null,8,["label","value"]))),128))]),_:1}),n(s,{label:"噩梦"},{default:c(()=>[(g(!0),v(k,null,B(d(zl),o=>(g(),M(l,{key:o.id,label:o.label,value:o.id},null,8,["label","value"]))),128))]),_:1})]),_:1})}}}),Ii={class:"text-xs"},Ti={class:"sk-tag text-xs"},Li=J({__name:"WolfSkillTable",props:{wolf:{}},emits:["change"],setup(_,{emit:t}){const e=_,l=t,s=ie(),i=W.groupBy(b.$_skillAtt_Obj.monsterSkill,D=>D.kindId);W.each(i,(D,O)=>i[O]=W.sortBy(D,"id"));const o=Object.keys(i).sort();let r=me([]);gt(()=>e.wolf.data.id,()=>{var D,O;e.wolf.initSkills(),r.length=0,r.push(...e.wolf.skillList.map((C,R)=>h(C,R))),(D=s.value)==null||D.clearSelection(),(O=s.value)==null||O.toggleAllSelection()});const h=(D,O=0)=>me({index:O,kindId:D.data.kindId,id:D.data.id,name:D.data.name,level:D.level,levelMax:D.levelMax,score:D.skillScore,info:D.skillInfo,tags:D.skillTag1+D.skillTag2+D.skillTag3,skill:D});function m(D){D.id=i[D.kindId][0].id,D.level=1,f(D)}const f=D=>{const O=r.indexOf(D),C=new ce(D.id,D.level,e.wolf).getSubClasses();e.wolf.skillList[O]=C,Object.assign(D,h(C,O)),l("change")},x=()=>{var O;const D=h(new ce("WeakFire_X1",1,e.wolf).getSubClasses(),r.length);r.push(D),(O=s.value)==null||O.toggleRowSelection(D,!0),l("change")},w=D=>{e.wolf.skillList.forEach(O=>O.enabled=D.find(C=>C.skill==O)!==void 0)};return(D,O)=>{const C=Ge,R=ye,E=Me,S=Ae,V=ct;return g(),v("div",null,[n(d(We),{ref_key:"skillTableRef",ref:s,data:d(r),"row-key":"index",style:{"font-size":"small"},onSelectionChange:w},{default:c(()=>[n(C,{type:"selection","reverse-selection":"",width:30}),n(C,{label:"KindId",width:160,"header-align":"center"},{default:c(y=>[n(E,{modelValue:y.row.kindId,"onUpdate:modelValue":X=>y.row.kindId=X,onChange:X=>m(y.row),style:{"font-size":"small"}},{default:c(()=>[(g(!0),v(k,null,B(d(o),X=>(g(),M(R,{key:X,label:X,value:X},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),n(C,{label:"Id",width:200,"header-align":"center"},{default:c(y=>[n(E,{modelValue:y.row.id,"onUpdate:modelValue":X=>y.row.id=X,onChange:X=>f(y.row),style:{"font-size":"small"}},{default:c(()=>[(g(!0),v(k,null,B(d(i)[y.row.kindId],X=>(g(),M(R,{key:X.id,label:X.id,value:X.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),n(C,{prop:"name",label:"Name",width:120,"header-align":"center",align:"center"}),n(C,{prop:"level",label:"Level",width:120,"header-align":"center",align:"center"},{default:c(y=>[n(S,{modelValue:y.row.level,"onUpdate:modelValue":X=>y.row.level=X,min:1,max:y.row.levelMax,size:"small",style:{width:"80px"},onChange:X=>f(y.row)},null,8,["modelValue","onUpdate:modelValue","max","onChange"])]),_:1}),n(C,{prop:"levelMax",label:"Level Max",width:120,"header-align":"center",align:"center"}),n(C,{prop:"score",label:"Score",width:120,"header-align":"center",align:"center"}),n(C,{label:"Info"},{default:c(y=>[I("span",Ii,T(y.row.info),1),I("span",Ti,T(y.row.tags),1)]),_:1})]),_:1},8,["data"]),n(V,{onClick:x},{default:c(()=>[N("增加一行")]),_:1})])}}});const Di=Ye(Li,[["__scopeId","data-v-ddfed7e7"]]),vi={class:"ml-2"},Si={class:"ml-8"},Ni=I("p",null,"技能",-1),bi=J({__name:"wolf-calc-one",props:{wolf:{}},setup(_){const t=me({wid:"al",level:1,expMax:0}),e=_;s();const l=i=>{e.wolf.updateData(i),s()};gt(()=>e.wolf.level,s);function s(){e.wolf.refreshLevel(),t.expMax=e.wolf.expMax}return(i,o)=>{const r=je,h=Ae,m=Xe;return g(),v(k,null,[n(m,{"label-width":80},{default:c(()=>[n(r,{label:"狼"},{default:c(()=>[n(Ei,{modelValue:d(t).wid,"onUpdate:modelValue":o[0]||(o[0]=f=>d(t).wid=f),onChange:l},null,8,["modelValue"])]),_:1}),n(r,{label:"等级"},{default:c(()=>[n(h,{modelValue:i.wolf.m_level,"onUpdate:modelValue":o[1]||(o[1]=f=>i.wolf.m_level=f),min:1},null,8,["modelValue"]),I("span",vi,"最高等级："+T(i.wolf.levelMax),1)]),_:1}),n(r,{label:"速度"},{default:c(()=>[N(T(i.wolf.monsterData.speedBase),1)]),_:1}),n(r,{label:"升级经验"},{default:c(()=>[N(T(d(t).expMax),1)]),_:1}),n(r,{label:"血量"},{default:c(()=>[N(T(i.wolf.hpMax),1)]),_:1}),n(r,{label:"实力"},{default:c(()=>[N(T(i.wolf.power),1)]),_:1})]),_:1}),I("div",Si,[Ni,n(Di,{wolf:i.wolf},null,8,["wolf"])])],64)}}}),xi=I("h2",null,"狼相关计算",-1),wi=J({__name:"wolf-calc",setup(_){const t=me([new ut("dahuil")]),e=ie(t[0].index),l=G(()=>{const[i,o]=b.$_wolf_worth_factor;return Math.round(Math.pow(W.sumBy(t,r=>Math.pow(r.power,i)),o))}),s=(i,o)=>{if(o==="add"){const r=new ut("dahuil");t.push(r),e.value=r.index}else if(o==="remove"){const r=t;let h=e.value;h===i&&r.forEach((m,f)=>{if(m.index===i){const x=r[f+1]||r[f-1];x&&(h=x.index)}}),e.value=h,t.splice(t.findIndex(m=>m.index===i),1)}};return(i,o)=>{const r=bl,h=xl;return g(),v("div",null,[xi,I("div",null,"总实力："+T(d(l)),1),n(h,{modelValue:d(e),"onUpdate:modelValue":o[0]||(o[0]=m=>$e(e)?e.value=m:null),type:"border-card",editable:"",onEdit:s,class:"m-4"},{default:c(()=>[(g(!0),v(k,null,B(d(t),(m,f)=>(g(),M(r,{key:m.index,label:m.monsterData.name,name:m.index},{default:c(()=>[n(bi,{wolf:m},null,8,["wolf"])]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])])}}}),Ci=Object.freeze(Object.defineProperty({__proto__:null,default:wi},Symbol.toStringTag,{value:"Module"})),_t=_=>(ol("data-v-47137969"),_=_(),ul(),_),Ri=_t(()=>I("h1",null,"狼数据",-1)),Ki=_t(()=>I("p",null,"前排解释：",-1)),Oi=_t(()=>I("p",null,"pop 为狼在一波中占的容量，一般来说 pop 越大则出现机会越少。",-1)),Pi=_t(()=>I("p",null,"charm 影响到寻路，charm 为负值越小则其他狼越会排斥它。",-1)),yi=_t(()=>I("p",null,"hp_factor 影响血量关于等级增长，是二次函数系数。",-1)),Mi={class:"sk-list"},ki={key:0,class:"sk-debuff"},Fi={key:1,class:"sk-buff"},Ui={class:"sk-name"},Vi={class:"sk-id"},$i={class:"sk-info"},Bi={key:2,class:"sk-tag"},Hi={key:3,class:"sk-tag"},Gi={key:4,class:"sk-tag"},Wi=J({__name:"wolfs",setup(_){console.log("init wolfs");const t=W.map(b.$_wolfAtt_Obj,(e,l)=>l).sort().map(e=>{let l=new ut(e,0,0);l.initSkills();let s=l.monsterData;return{id:e,data:s,skills:Object.values(l.skills)}});return console.log(t),(e,l)=>{const s=Ge,i=We;return g(),v(k,null,[Ri,Ki,Oi,Pi,yi,n(i,{data:d(t),"default-sort":{prop:"id",order:"ascending"},"table-layout":"auto",stripe:"","header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"},"row-key":"id","max-height":"600",style:{width:"100%","max-width":"1200px"}},{default:c(()=>[n(s,{prop:"id",label:"id",sortable:"",width:150}),n(s,{prop:"data.name",label:"name",sortable:""}),n(s,{prop:"data.speedBase",label:"speedBase",sortable:""}),n(s,{prop:"data.population",label:"population",sortable:""}),n(s,{prop:"data.charm",label:"charm",sortable:"",width:100}),n(s,{label:"size"},{default:c(()=>[n(s,{prop:"data.width",label:"width",sortable:"",width:100}),n(s,{prop:"data.height",label:"height",sortable:"",width:100})]),_:1}),n(s,{label:"hpFactor"},{default:c(()=>[n(s,{prop:"data.hpMaxA",label:"a",sortable:"",width:100}),n(s,{prop:"data.hpMaxB",label:"b",sortable:"",width:100}),n(s,{prop:"data.hpMaxC",label:"c",sortable:"",width:100})]),_:1}),n(s,{label:"skills",type:"expand",width:"60"},{default:c(o=>[I("div",Mi,[(g(!0),v(k,null,B(o.row.skills,r=>(g(),v("p",{key:r.data.id},[r.isDebuff?(g(),v("span",ki,"↓")):(g(),v("span",Fi,"↑")),I("span",Ui,T(r.name),1),I("span",Vi,"["+T(r.data.id)+"]",1),I("span",$i,T(r.skillInfo),1),r.skillTag1?(g(),v("span",Bi,T(r.skillTag1),1)):pe("",!0),r.skillTag2?(g(),v("span",Hi,T(r.skillTag2),1)):pe("",!0),r.skillTag3?(g(),v("span",Gi,T(r.skillTag3),1)):pe("",!0)]))),128))])]),_:1})]),_:1},8,["data"])],64)}}});const ji=Ye(Wi,[["__scopeId","data-v-47137969"]]),Xi=Object.freeze(Object.defineProperty({__proto__:null,default:ji},Symbol.toStringTag,{value:"Module"}));
